<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.9.16">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alec Loudenback">

<title>13&nbsp; Elements of Computer Science – Modern Financial Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./statistics.html" rel="next">
<link href="./software.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3ae586159be244f9b7da5612ca3882f5.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-4bdbedee417e7c90344270729bc2963b.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3ae586159be244f9b7da5612ca3882f5.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6ee83196eee0eba8702f4dd364e0de5e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-860856505d205c70e29714261f4c7ddb.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-6ee83196eee0eba8702f4dd364e0de5e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script data-goatcounter="https://julia-fin-book.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./computational-thinking.html">Interdisciplinary Concepts and Applications</a></li><li class="breadcrumb-item"><a href="./elements-of-compsci.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Elements of Computer Science</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modern Financial Modeling</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./why-program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Program?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./why-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Why use Julia?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./foundations-financial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations: Effective Financial Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elements-of-financial-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Elements of Financial Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial-modeling-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Practice of Financial Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./conceptual-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations: Programming and Abstractions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-of-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Elements of Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-abstractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Functional Abstractions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./type-abstractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data and Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./patterns-abstraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Higher Levels of Abstraction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./conceptual-foundations2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations: Building Performant Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hardware.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hardware and Its Implications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Writing Performant Single-Threaded Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parallelization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Parallelization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./computational-thinking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interdisciplinary Concepts and Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Applying Software Engineering Practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elements-of-compsci.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Elements of Computer Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistical Inference and Information Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Stochastic Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autodiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Automatic Differentiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Matrices and Their Uses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Learning from Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./julia-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Developing in Julia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Writing Julia Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Troubleshooting Julia Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-sharing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Distributing and Sharing Julia Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-optimizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimizing Julia Code</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applied Financial Modeling Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scenario-generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Scenario Generation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity-calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Similarity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./portfolio-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Portfolio Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sensitivity-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autodiff_alm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Auto-differentiation and Asset Liability Management (AAD &amp; ALM)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Stochastic Mortality Projections</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Bayesian Mortality Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-techniques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">More Useful Techniques</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecosystem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">The Julia Ecosystem Today</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview"><span class="header-section-number">13.1</span> Chapter Overview</a></li>
  <li><a href="#computer-science-for-financial-professionals" id="toc-computer-science-for-financial-professionals" class="nav-link" data-scroll-target="#computer-science-for-financial-professionals"><span class="header-section-number">13.2</span> Computer Science for Financial Professionals</a></li>
  <li><a href="#algorithms" id="toc-algorithms" class="nav-link" data-scroll-target="#algorithms"><span class="header-section-number">13.3</span> Algorithms</a></li>
  <li><a href="#complexity" id="toc-complexity" class="nav-link" data-scroll-target="#complexity"><span class="header-section-number">13.4</span> Complexity</a>
  <ul class="collapse">
  <li><a href="#computational-complexity" id="toc-computational-complexity" class="nav-link" data-scroll-target="#computational-complexity"><span class="header-section-number">13.4.1</span> Computational Complexity</a></li>
  <li><a href="#space-complexity" id="toc-space-complexity" class="nav-link" data-scroll-target="#space-complexity"><span class="header-section-number">13.4.2</span> Space Complexity</a></li>
  <li><a href="#complexity-takeaways" id="toc-complexity-takeaways" class="nav-link" data-scroll-target="#complexity-takeaways"><span class="header-section-number">13.4.3</span> Complexity: Takeaways</a></li>
  </ul></li>
  <li><a href="#data-structures" id="toc-data-structures" class="nav-link" data-scroll-target="#data-structures"><span class="header-section-number">13.5</span> Data Structures</a>
  <ul class="collapse">
  <li><a href="#arrays" id="toc-arrays" class="nav-link" data-scroll-target="#arrays"><span class="header-section-number">13.5.1</span> Arrays</a></li>
  <li><a href="#linked-lists" id="toc-linked-lists" class="nav-link" data-scroll-target="#linked-lists"><span class="header-section-number">13.5.2</span> Linked Lists</a></li>
  <li><a href="#sec-struct-bits" id="toc-sec-struct-bits" class="nav-link" data-scroll-target="#sec-struct-bits"><span class="header-section-number">13.5.3</span> Records/Structs</a></li>
  <li><a href="#dictionaries-hash-tables" id="toc-dictionaries-hash-tables" class="nav-link" data-scroll-target="#dictionaries-hash-tables"><span class="header-section-number">13.5.4</span> Dictionaries (Hash Tables)</a></li>
  <li><a href="#graphs" id="toc-graphs" class="nav-link" data-scroll-target="#graphs"><span class="header-section-number">13.5.5</span> Graphs</a></li>
  <li><a href="#sec-data-trees" id="toc-sec-data-trees" class="nav-link" data-scroll-target="#sec-data-trees"><span class="header-section-number">13.5.6</span> Trees</a></li>
  <li><a href="#data-structures-conclusion" id="toc-data-structures-conclusion" class="nav-link" data-scroll-target="#data-structures-conclusion"><span class="header-section-number">13.5.7</span> Data Structures Conclusion</a></li>
  </ul></li>
  <li><a href="#verification-and-advanced-testing" id="toc-verification-and-advanced-testing" class="nav-link" data-scroll-target="#verification-and-advanced-testing"><span class="header-section-number">13.6</span> Verification and Advanced Testing</a>
  <ul class="collapse">
  <li><a href="#sec-formal-verification" id="toc-sec-formal-verification" class="nav-link" data-scroll-target="#sec-formal-verification"><span class="header-section-number">13.6.1</span> Formal Verification</a></li>
  <li><a href="#property-based-testing" id="toc-property-based-testing" class="nav-link" data-scroll-target="#property-based-testing"><span class="header-section-number">13.6.2</span> Property Based Testing</a></li>
  <li><a href="#fuzzing" id="toc-fuzzing" class="nav-link" data-scroll-target="#fuzzing"><span class="header-section-number">13.6.3</span> Fuzzing</a></li>
  </ul></li>
  <li><a href="#sec-portfolio-complexity" id="toc-sec-portfolio-complexity" class="nav-link" data-scroll-target="#sec-portfolio-complexity"><span class="header-section-number">13.7</span> Finance Example: Complexity and Portfolio Selection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./computational-thinking.html">Interdisciplinary Concepts and Applications</a></li><li class="breadcrumb-item"><a href="./elements-of-compsci.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Elements of Computer Science</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Elements of Computer Science</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alec Loudenback </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>“Fundamentally, computer science is a science of abstraction—creating the right model for a problem and devising the appropriate mechanizable techniques to solve it. Confronted with a problem, we must create an abstraction of that problem that can be represented and manipulated inside a computer. Through these manipulations, we try to find a solution to the original problem.” — Al Aho and Jeff Ullman (1992)</p>
</blockquote>
<section id="chapter-overview" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="chapter-overview"><span class="header-section-number">13.1</span> Chapter Overview</h2>
<p>Adapting computer science concepts to work for financial professionals. Computability, computational complexity, and the language of algorithms and problem solving. A survey of important data structures. More advanced testing and verification topics.</p>
</section>
<section id="computer-science-for-financial-professionals" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="computer-science-for-financial-professionals"><span class="header-section-number">13.2</span> Computer Science for Financial Professionals</h2>
<p>Computer science as a term can be a bit misleading because of the overwhelming association with the physical desktop or laptop machines that we call “computers”. The discipline of computer science is much richer than consumer electronics: at its core, computer science concerns itself with areas of research and answering tough questions—many of which surface immediately in quantitative finance:</p>
<ul>
<li><strong>Algorithms and Optimization</strong>. How can a problem be solved efficiently? How can that problem be solved <em>at all</em>? Given constraints, how can one find an optimal solution for rebalance schedules, scenario selection, or funding plans?</li>
<li><strong>Theory of Computation</strong>. What sorts of questions are even answerable? Is an answer easy to compute or will resolving it require more resources than the entire known universe? Will a computation ever stop calculating (e.g., will a nested capital calculation or Monte Carlo loop converge in time)?</li>
<li><strong>Data Structures</strong>. How to encode, store, and use data? How does that data relate to each other and what are the trade-offs between different representations of that data?</li>
<li><strong>Information Theory</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Given limited data, what <em>can</em> be known or inferred from it?</li>
</ul>
<p>For a reader in the twenty-first century we hope that it is patently obvious how impactful the <em>applied</em> computer science has been as end-users of the internet, artificial intelligence, computational photography, safety control systems, etc. have been to our lives. It is a testament to the utility of being able to harness computer science ideas for practical use.</p>
<p>It’s common for beneficial advances in knowledge and application to occur at the boundary between two disciplines. It’s here in this chapter that we desire to bring together the financial discipline with computer science and to provide the financial practitioner with the language and concepts to leverage some of computer science’s most relevant ideas.</p>
</section>
<section id="algorithms" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="algorithms"><span class="header-section-number">13.3</span> Algorithms</h2>
<p>An <strong>Algorithm</strong> is a general term for a process that transforms an input to an output. It’s the set of instructions dictating how to carry out a process. That process needs to be specified in sufficient detail to be able to call itself an algorithm (versus a <em>heuristic</em> which lacks that specificity).</p>
<p>An algorithm might be the directions to accomplish the following task: summing a series of consecutive integers from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. There are multiple ways that this might be accomplished, each one considered a distinct algorithm:</p>
<ul>
<li><p>iterating over each number and summing them up (starting with the smallest number)</p></li>
<li><p>iterating over each number and summing them up (starting with the largest number)</p></li>
<li><p>summing up the evens and then the odds, then adding the two subtotals</p></li>
<li><p>and many more distinct algorithms…</p></li>
</ul>
<p>We will look at some specific examples of these alternate algorithms as we introduce the next topic, computational complexity.</p>
</section>
<section id="complexity" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="complexity"><span class="header-section-number">13.4</span> Complexity</h2>
<section id="computational-complexity" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="computational-complexity"><span class="header-section-number">13.4.1</span> Computational Complexity</h3>
<p>We can characterize the computational complexity of a problem by looking at how long an algorithm takes to complete a task when given an input of size <span class="math inline">\(n\)</span>. We can then compare two approaches to see which is computationally less complex for a given <span class="math inline">\(n\)</span>. This is a way of systematically evaluating an algorithm to determine its efficiency when being computed.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that computational complexity isn’t quite the same as how fast an algorithm will run on your computer, but it’s a very good guide. Modern computer architectures can sometimes execute multiple instructions in a single cycle of the CPU making an algorithm that is, on paper slower than another, actually run faster in practice. Additionally, sometimes algorithms are able to substantially limit the number of <em>computations</em> to be performed, at the expense of using a lot more <em>memory</em> and thereby trading CPU usage with RAM usage.</p>
<p>You can think of computational complexity as a measure of how much work is to be performed. Sometimes the computer is able to perform certain kinds of work more efficiently.</p>
<p>Further, when we analyze an algorithm recall that ultimately our code gets translated into instructions for the computer hardware. Some instructions are implemented in a way that for any type of number (e.g.&nbsp;floating point), it doesn’t matter if the number is <code>1.0</code> or <code>0.41582574300044717</code>, the operation will take the exact same time and number of instructions to execute (e.g.&nbsp;for the addition operation).</p>
<p>Sometimes a higher level operation is implemented in a way that takes many machine instructions. For example, division instructions may require many CPU cycles when compared to addition or multiplication. Sometimes this is an important distinction and sometimes not. For this book we will ignore this granularity of analysis.</p>
</div>
</div>
<section id="example-sum-of-consecutive-integers" class="level4" data-number="13.4.1.1">
<h4 data-number="13.4.1.1" class="anchored" data-anchor-id="example-sum-of-consecutive-integers"><span class="header-section-number">13.4.1.1</span> Example: Sum of Consecutive Integers</h4>
<p>Take for example the problem of determining the sum of integers from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. We will explore three different algorithms and the associated computational complexity for them.</p>
<section id="constant-time" class="level5" data-number="13.4.1.1.1">
<h5 data-number="13.4.1.1.1" class="anchored" data-anchor-id="constant-time"><span class="header-section-number">13.4.1.1.1</span> Constant Time</h5>
<p>A mathematical proof can show a simple formula for the result. This allows us to compute the answer in <strong>constant time</strong>, which means that for any <span class="math inline">\(n\)</span>, our algorithm is essentially the same amount of work.</p>
<div id="4" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nsum_constant</span>(n) <span class="op">=</span> n <span class="op">*</span> (n <span class="op">+</span> <span class="fl">1</span>) <span class="op">÷</span> <span class="fl">2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>nsum_constant (generic function with 1 method)</code></pre>
</div>
</div>
<p>In this we see that we perform three operations: a multiplication, a sum, and a division, no matter what n is. If <code>n</code> is <code>10_000_000</code> we’d expect this to complete in about a single unit of time.</p>
</section>
<section id="linear-time" class="level5" data-number="13.4.1.1.2">
<h5 data-number="13.4.1.1.2" class="anchored" data-anchor-id="linear-time"><span class="header-section-number">13.4.1.1.2</span> Linear Time</h5>
<p>This algorithm performs a number of operations which grows in proportion with <span class="math inline">\(n\)</span> by individually summing up each element in <span class="math inline">\(1\)</span> through <span class="math inline">\(n\)</span>:</p>
<div id="6" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">nsum_linear</span>(n)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> i</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    result</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>nsum_linear (generic function with 1 method)</code></pre>
</div>
</div>
<p>If <span class="math inline">\(n\)</span> were <code>10_000_000</code>, we’d expect it to run with roughly 10 million operations, or about 3 million times as many operations as the constant time version. We can say that this version of the algorithm will take approximately <span class="math inline">\(n\)</span> steps to complete.</p>
</section>
<section id="quadratic-time" class="level5" data-number="13.4.1.1.3">
<h5 data-number="13.4.1.1.3" class="anchored" data-anchor-id="quadratic-time"><span class="header-section-number">13.4.1.1.3</span> Quadratic Time</h5>
<p>What if we were less efficient, and instead we were only ever able to increment our subtotal by one. That is, instead of adding up <span class="math inline">\(1+3\)</span>, we had to instead do four operations: <span class="math inline">\(1+1+1+1\)</span> . We can add a second loop which increments our result by a unit instead of simply adding the current <code>i</code> to the running total <code>result</code>. This makes our algorithm work much harder since it has to add numbers so many more times (Recall that to a computer adding two numbers is the same computational effort regardless of what the numbers are).</p>
<div id="8" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode julia code-annotation-code code-with-copy code-annotated"><code class="sourceCode julia"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">nsum_quadratic</span>(n)</span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="fl">0</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-3-3" class="code-annotation-target"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>i</span>
<span id="annotated-cell-3-5"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> <span class="fl">1</span></span>
<span id="annotated-cell-3-6"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="annotated-cell-3-8"><a href="#annotated-cell-3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-3-9"><a href="#annotated-cell-3-9" aria-hidden="true" tabindex="-1"></a>    result</span>
<span id="annotated-cell-3-10"><a href="#annotated-cell-3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="3" data-code-annotation="1">The outer loop with iterator <code>i</code>. loops over the integers <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">The inner loop with iterator <code>j</code> does the busy work of adding <span class="math inline">\(1\)</span> to our subtotal <code>i</code> times.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>nsum_quadratic (generic function with 1 method)</code></pre>
</div>
</div>
<p>Breaking down the steps:</p>
<ul>
<li>When <code>i</code> is <code>1</code> there is 1 addition in the inner loop</li>
<li>When <code>i</code> is <code>2</code> there are 2 additions in the inner loop</li>
<li>…</li>
<li>When <code>i</code> is <code>n</code> there are <code>n</code> additions in the inner loop</li>
</ul>
<p>Therefore, this computation takes <span class="math inline">\((1 + 2 + \cdots + n\)</span> steps to complete. Algebraically, this simplifies down to our constant time formula: it requires <span class="math inline">\(n * (n + 1) ÷ 2\)</span> or <span class="math inline">\((n^2 + n) / 2\)</span> steps to complete.</p>
</section>
</section>
<section id="comparison" class="level4" data-number="13.4.1.2">
<h4 data-number="13.4.1.2" class="anchored" data-anchor-id="comparison"><span class="header-section-number">13.4.1.2</span> Comparison</h4>
<section id="big-o-notation" class="level5" data-number="13.4.1.2.1">
<h5 data-number="13.4.1.2.1" class="anchored" data-anchor-id="big-o-notation"><span class="header-section-number">13.4.1.2.1</span> Big-O Notation</h5>
<p>We can categorize the above implementations using a convention called <strong>Big-O Notation</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> which is a way of distilling and classifying computational complexity. We characterize the algorithms by the most significant term in the total number of operations. <a href="#tbl-complexity-sum" class="quarto-xref">Table&nbsp;<span>13.1</span></a> shows for the examples constructed above what the description, order, and order of magnitude complexity is.</p>
<div id="tbl-complexity-sum" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-complexity-sum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.1: Complexity comparison for the three sample cases of summing integers from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>.
</figcaption>
<div aria-describedby="tbl-complexity-sum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Computational Cost</th>
<th>Complexity Description</th>
<th>Big-O Order</th>
<th>Steps (<span class="math inline">\(n=10,000\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>nsum_constant</code></td>
<td>fixed</td>
<td>Constant</td>
<td><span class="math inline">\(O(1)\)</span></td>
<td>~1</td>
</tr>
<tr class="even">
<td><code>nsum_linear</code></td>
<td><span class="math inline">\(n\)</span></td>
<td>Linear</td>
<td><span class="math inline">\(O(n)\)</span></td>
<td>~10,000</td>
</tr>
<tr class="odd">
<td><code>nsum_quadratic</code></td>
<td><span class="math inline">\(n^2 + n ÷ 2\)</span></td>
<td>Quadratic</td>
<td><span class="math inline">\(O(n^2)\)</span></td>
<td>~100,000,000</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><a href="#tbl-complexity-generic" class="quarto-xref">Table&nbsp;<span>13.2</span></a> shows a comparison of a more extended set of complexity levels. For the most complex categories of problems, the cost to compute grows so fast that it boggles the mind. What sorts of problems fall into the most complex categories? <span class="math inline">\(O(2^n)\)</span>, or exponential complexity, examples include the traveling salesman problem<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> if solved with dynamic programming or the recursive approach to calculating the <span class="math inline">\(nth\)</span> Fibonacci number. The beastly <span class="math inline">\(O(n!)\)</span> algorithms include brute force solving the traveling salesman problem or enumerating all partitions of a set. In financial modeling, we may encounter these sorts of problems in portfolio optimization (using the brute-force approach of testing every potential combination assets to optimize a portfolio).</p>
<div id="tbl-complexity-generic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-complexity-generic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.2: Different Big-O Orders of Complexity
</figcaption>
<div aria-describedby="tbl-complexity-generic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Big-O Order</th>
<th>Description</th>
<th><span class="math inline">\(n=10\)</span></th>
<th><span class="math inline">\(n=1,000\)</span></th>
<th><span class="math inline">\(n=1,000,000\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(O(1)\)</span></td>
<td>Constant Time</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(O(n)\)</span></td>
<td>Linear Time</td>
<td>10</td>
<td>1,000</td>
<td>1,000,000</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(O(n^2)\)</span></td>
<td>Quadratic Time</td>
<td>100</td>
<td>1,000,000</td>
<td>10^12</td>
</tr>
<tr class="even">
<td><span class="math inline">\(O(log(n))\)</span></td>
<td>Logarithmic Time</td>
<td>3</td>
<td>7</td>
<td>14</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(O(n\times log(n))\)</span></td>
<td>Linearithmic Time</td>
<td>30</td>
<td>7,000</td>
<td>14,000,000</td>
</tr>
<tr class="even">
<td><span class="math inline">\(O(2^n)\)</span></td>
<td>Exponential Time</td>
<td>1,024</td>
<td>~10^300</td>
<td>~10^301029</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(O(n!)\)</span></td>
<td>Factorial Time</td>
<td>3,628,800</td>
<td>~10^2567</td>
<td>~10^5565708</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We care only about the most significant term because when <span class="math inline">\(n\)</span> is large, the most significant term tends to dominate. For example, in our quadratic time example which has <span class="math inline">\(n^2 + n ÷ 2\)</span> steps, if <span class="math inline">\(n\)</span> is a large number like <span class="math inline">\(10^6\)</span>, then we see that it will result in:</p>
<p><span class="math display">\[\begin{align*}
n^2 + \frac{n}{2} &amp;= (10^6)^2 + \frac{10^6}{2} \\
                  &amp;= 10^{12} + \frac{10^6}{2}
\end{align*}\]</span></p>
<p><span class="math inline">\(10^{12}\)</span> is <em>significantly</em> more important than <span class="math inline">\(\frac{10^6}{2}\)</span> (sixty-four million times as important, to be precise). This is why Big-O notation reduces the problem down to only the most significant complexity cost term.</p>
<p>If n is small then we don’t really care about computational complexity in general. This is a lesson for our efforts as developers: focus on the most intensive parts of calculations when looking to optimize, and don’t worry about seldom used portions of the code.</p>
</div>
</div>
</section>
<section id="empirical-results" class="level5" data-number="13.4.1.2.2">
<h5 data-number="13.4.1.2.2" class="anchored" data-anchor-id="empirical-results"><span class="header-section-number">13.4.1.2.2</span> Empirical Results</h5>
<p>The preceding examples of constant, linear, and quadratic times are <em>conceptually</em> correct but if we try to run them in practice we see that the description doesn’t seem to hold at all for the linear time version, as it runs as quickly as the constant time version.</p>
<div id="10" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">nsum_constant</span>(<span class="fl">10_000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0.958 ns (0 allocations: 0 bytes)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>50005000</code></pre>
</div>
</div>
<div id="12" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">nsum_linear</span>(<span class="fl">10_000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1.666 ns (0 allocations: 0 bytes)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>50005000</code></pre>
</div>
</div>
<div id="14" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">nsum_quadratic</span>(<span class="fl">10_000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1.238 μs (0 allocations: 0 bytes)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>50005000</code></pre>
</div>
</div>
<p>What happened was that the compiler was able to understand and optimize the linear version such that it effectively transformed it into the constant time version and avoid the iterative summation that we had written. For examples that are simple enough to use as a teaching problem, the compiler can often optimize different written code down to the same efficient machine code (this is the same Triangular Number optimization we saw in <a href="foundations-of-programming.html#sec-programming-ranges" class="quarto-xref"><span>Section 5.4.3.4</span></a>).</p>
</section>
</section>
<section id="expected-versus-worst-case-complexity" class="level4" data-number="13.4.1.3">
<h4 data-number="13.4.1.3" class="anchored" data-anchor-id="expected-versus-worst-case-complexity"><span class="header-section-number">13.4.1.3</span> Expected versus worst-case complexity</h4>
<p>Another consideration is that there may be one approach which performs better in the majority of cases, at the expense of having very poor performance in specific cases. Sometimes we may risk those high cost cases if we expect the benefit to be worthwhile on the rest of the problem set.</p>
<p>This often happens when the data we are working with has some concept of “distance”. For example, in multi-stop route planning we can use the idea that it’s likely to be more efficient to visit nearby destinations first. Generally this works, but sometimes the nearest distance actually has a high cost (such as needing to avoid real-world obstacles in the way which force you to drive past other further away locations to get there).</p>
</section>
</section>
<section id="space-complexity" class="level3" data-number="13.4.2">
<h3 data-number="13.4.2" class="anchored" data-anchor-id="space-complexity"><span class="header-section-number">13.4.2</span> Space Complexity</h3>
<p>So far we have focused on computational complexity, however similar analysis could be performed for <strong>space complexity</strong>, which is how much computer memory is required to solve a problem. Sometimes, an algorithm will trade computational complexity for space complexity. That is, we might be able to solve a problem much faster if we have more memory available.</p>
<p>For example, there has been research to improve the computational efficiency of matrix multiplication which do indeed run faster than traditional techniques. However, those algorithms don’t get implemented in general linear algebra libraries because they require way more memory than is available!</p>
</section>
<section id="complexity-takeaways" class="level3" data-number="13.4.3">
<h3 data-number="13.4.3" class="anchored" data-anchor-id="complexity-takeaways"><span class="header-section-number">13.4.3</span> Complexity: Takeaways</h3>
<p>The idea of algorithmic complexity is important because it grounds us in the harsh truth that some problems are <em>very</em> difficult to compute. It’s in these cases that a lot of the creativity and domain specific heuristics can become the foremost consideration.</p>
<p>We must remember to be thoughtful about the design of our models. When searching for additional performance, hunt for the “loops-within-loops”—that is where combinatorial explosions tend to happen. Focusing on the places that have large <span class="math inline">\(n\)</span> or poor Big-O order can transform the performance of the overall model. Sometimes the fundamental complexity of the problem forbids greater efficiency, but many finance workflows benefit from reframing the problem (e.g.&nbsp;relaxing binary constraints or using approximation algorithms) before brute force becomes unavoidable.</p>
<p>See the end of this chapter, <a href="#sec-portfolio-complexity" class="quarto-xref"><span>Section 13.7</span></a> for an example demonstrating computational complexity in the context of portfolio selection.</p>
</section>
</section>
<section id="data-structures" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="data-structures"><span class="header-section-number">13.5</span> Data Structures</h2>
<p>The science of <strong>data structures</strong> is about how data is represented conceptually and in computer applications.</p>
<p>For example, how should the string “abcdef” be represented and analyzed?</p>
<p>There are many common data structures and many specialized subtypes. We will describe some of the most common ones here. Julia has many data structures available in the Base library, but an extensive collection of other data structures can be found in the <a href="https://github.com/JuliaCollections/DataStructures.jl">DataStructures.jl package</a>.</p>
<section id="arrays" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="arrays"><span class="header-section-number">13.5.1</span> Arrays</h3>
<p>An <strong>array</strong> is a contiguous block of memory containing elements of the same type, accessed via integer indices. Arrays have fast random access and are the fastest data structure for linear/iterated access of data.</p>
<p>In Julia, an array is a very common data structure and is implemented with a simple declaration, such as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In memory, the integers are stored as consecutive bits representing the integer values of <code>1</code>, <code>2</code>, and <code>3</code>. The actual bits in memory would look like this (with the different integers shown on new lines for clarity):</p>
<pre><code>0000000000000000000000000000000000000000000000000000000000000001
0000000000000000000000000000000000000000000000000000000000000010
0000000000000000000000000000000000000000000000000000000000000011</code></pre>
<p>This is great for accessing the values one-by-one or in consecutive groups, but it’s not efficient if values need to be inserted in between. For example, if we wanted to insert <code>0</code> between the <code>1</code> and <code>2</code> in <code>x</code>, then we’d need to overwrite the second position in the array, ask the operating system to allocate more memory<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, and re-write the bytes that come after our new value. Inserting values at the end (<code>push!(array, value)</code>) is usually fast unless more memory needs to be allocated.</p>
</section>
<section id="linked-lists" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="linked-lists"><span class="header-section-number">13.5.2</span> Linked Lists</h3>
<p>A <strong>linked list</strong> is a chain of nodes where each node contains a value and a pointer to the next node. Linked lists allow for efficient insertion and deletion but slower random access compared to arrays.</p>
<p>In Julia, a simple linked list node can be implemented generically so it remains type-stable:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="annotated-cell-9"><pre class="sourceCode julia code-annotation-code code-with-copy code-annotated"><code class="sourceCode julia"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mutable struct</span> Node{T}</span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a>    value<span class="op">::</span><span class="dt">T</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-9-3" class="code-annotation-target"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a>    next<span class="op">::</span><span class="dt">Union{Node{T}, Nothing}</span></span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> <span class="fu">Node</span>(<span class="fl">3</span>, <span class="cn">nothing</span>)</span>
<span id="annotated-cell-9-7"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">Node</span>(<span class="fl">2</span>, z)</span>
<span id="annotated-cell-9-8"><a href="#annotated-cell-9-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">Node</span>(<span class="fl">1</span>, y)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="3" data-code-annotation="1"><code>Nothing</code> represents the end of the linked list.</span>
</dd>
</dl>
<p>Inserting a new node between existing nodes is efficient - if we wanted to insert a new node between the ones with value <code>2</code> and <code>3</code>, we could do this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fu">Node</span>(<span class="fl">0</span>, z) <span class="co"># &lt;1&gt; Create a new `Node` with `next` equal to `z`</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>y.next <span class="op">=</span> a <span class="co"># &lt;2&gt; Set the reference to `next` in `y` to be the new `Node` `a`.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Accessing the nth element requires traversing the list from the beginning to check each <code>Node</code>’s <code>next</code> value. This iterative approach makes it <span class="math inline">\(O(n)\)</span> time complexity for random access. This is in contrast to an array where you know right away where the <span class="math inline">\(n\)</span>th item will be in the data structure.</p>
<p>Also, the linked list is one-directional. Items further down the chain don’t know what node points to them, so it’s impossible to traverse the list backwards.</p>
<p>There are many related implementations which make random access or traversal in reverse order more efficient such as doubly-linked lists or “trees” (<a href="#sec-data-trees" class="quarto-xref"><span>Section 13.5.6</span></a>) which organize the data not as a chain but as a tree with branching nodes.</p>
</section>
<section id="sec-struct-bits" class="level3" data-number="13.5.3">
<h3 data-number="13.5.3" class="anchored" data-anchor-id="sec-struct-bits"><span class="header-section-number">13.5.3</span> Records/Structs</h3>
<p>An aggregate of named fields, typically of fixed size and sequence. Records group related data together. We’ve encountered structs in <a href="foundations-of-programming.html#sec-user-defined-types" class="quarto-xref"><span>Section 5.4.7</span></a>, but here we’ll add that simple <code>structs</code> with primitive fields can themselves be represented without creating pointers to the data stored:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> SimpleBond</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    id<span class="op">::</span><span class="dt">Int</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    par<span class="op">::</span><span class="dt">Float64</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> LessSimpleBond</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    id<span class="op">::</span><span class="dt">String</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    par<span class="op">::</span><span class="dt">Float64</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fu">SimpleBond</span>(<span class="fl">1</span>, <span class="fl">100.0</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fu">LessSimpleBond</span>(<span class="st">"1"</span>, <span class="fl">100.0</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">isbits</span>(a), <span class="fu">isbits</span>(b)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(true, false)</code></pre>
</div>
</div>
<p>Because <code>a</code> is comprised of simple elements, it can be represented as a contiguous set of bits in memory. It would look something like this in memory:</p>
<pre id="annotated-cell-12" class="code-annotation-code"><code>0000000000000000000000000000000000000000000000000000000000000001
0100000001011001000000000000000000000000000000000000000000000000</code></pre>
<dl>
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="1" data-code-annotation="1">The bits of <code>1</code></span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="2" data-code-annotation="2">The bits of <code>100.0</code></span>
</dd>
</dl>
<p>In contrast, the <code>LessSimpleBond</code> uses a <code>String</code> to represent the ID of the bond. In Julia, String is an immutable type that internally references a buffer of bytes; because it holds a reference, a struct containing a String is not an isbits type.</p>
<pre id="annotated-cell-13" class="code-annotation-code"><code>.... a pointer ...
0100000001011001000000000000000000000000000000000000000000000000</code></pre>
<dl>
<dt data-target-cell="annotated-cell-13" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="1" data-code-annotation="1">a pointer/reference to the array of characters that comprise the string ID</span>
</dd>
<dt data-target-cell="annotated-cell-13" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="2" data-code-annotation="2">The bits of <code>100.0</code></span>
</dd>
</dl>
<p>In performance critical code, having data that is represented with simple bits instead of references/pointers can be much faster (see <a href="stochastic-mortality.html" class="quarto-xref"><span>Chapter 30</span></a> for an example).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For many mutable types, there are immutable, bits-types alternatives. For example:</p>
<ul>
<li><p>Arrays have a <code>StaticArray</code> counterpart (from the <a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl package</a>).</p></li>
<li><p>Strings have <code>InlineStrings</code> (from the <a href="https://github.com/JuliaStrings/InlineStrings.jl">InlineStrings.jl package</a>) which use fixed-width representations of strings.</p></li>
</ul>
<p>The downsides to the immutable alternatives (other than the loss of potentially desired flexibly that mutability provides) are that they can be harder on the compiler (more upfront compilation cost) to handle the specialized cases involved.</p>
</div>
</div>
</section>
<section id="dictionaries-hash-tables" class="level3" data-number="13.5.4">
<h3 data-number="13.5.4" class="anchored" data-anchor-id="dictionaries-hash-tables"><span class="header-section-number">13.5.4</span> Dictionaries (Hash Tables)</h3>
<section id="hashes-and-hash-functions." class="level4" data-number="13.5.4.1">
<h4 data-number="13.5.4.1" class="anchored" data-anchor-id="hashes-and-hash-functions."><span class="header-section-number">13.5.4.1</span> Hashes and Hash Functions.</h4>
<p><strong>Hashes</strong> are the result of a <strong>hash function</strong> that maps arbitrary data to a fixed size value. It’s sort of a “one way” mapping to a simpler value which has the benefits of:</p>
<ol type="1">
<li>One way so that if someone knows the hashed value, it’s <em>very</em> difficult to guess what the original value was. This is most useful in cryptographic and security applications.</li>
<li>Creating (probabilistically) unique IDs for a given set of data.</li>
</ol>
<p>For example, we can calculate an <strong>SHA hash</strong> on any data:</p>
<div id="18" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">SHA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="bu">SHA</span>.<span class="fu">sha256</span>(<span class="st">"hello world"</span>) <span class="op">|&gt;</span> bytes2hex</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="bu">SHA</span>.<span class="fu">sha256</span>(<span class="fu">rand</span>(<span class="dt">UInt8</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>)) <span class="op">|&gt;</span> bytes2hex</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(a)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(b)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9
2a95adb03212c74a34fc558a61cef5a57dc8a41e36f8fac28e113ea43c31b0b5</code></pre>
</div>
</div>
<p>We can easily verify that the <code>sha256</code> hash of <code>"hello world"</code> is the same each time, but it’s virtually impossible to guess <code>"hello world"</code> if we are just given the resulting hash. This is the premise of trying to “crack” a password when the stored password hash is stolen (real systems “salt” and “stretch” hashes to make the attack even harder - these topics are out of scope here).</p>
<p>One way to check if two sets of data are the same is to compute the hash and see if the resulting hashes are equal. For example, maybe you want to see if two data files with different names contain the same data - comparing the hashes is a sure way to determine if they contain the same data.</p>
</section>
<section id="dictionaries" class="level4" data-number="13.5.4.2">
<h4 data-number="13.5.4.2" class="anchored" data-anchor-id="dictionaries"><span class="header-section-number">13.5.4.2</span> Dictionaries</h4>
<p>Dictionaries map a <em>key</em> to a <em>value</em>. More specifically, they use the <em>hash of a key</em> to store a reference to the <em>value</em>.</p>
<p>Dictionaries offer constant-time average case access but must handle potential collisions of keys (generally, the more robust the collision handling means higher fixed cost for access).</p>
<p>Here’s an illustrative portfolio of assets indexed by CUSIPs:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>assets <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CUSIP =&gt; Asset</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"037833AH4"</span> <span class="op">=&gt;</span> <span class="fu">Bond</span>(<span class="st">"General Electric"</span>,<span class="op">...</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"912828M80"</span> <span class="op">=&gt;</span> <span class="fu">Equity</span>(<span class="st">"AAPL"</span>,<span class="op">...</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"594918BQ1"</span> <span class="op">=&gt;</span> <span class="fu">Bond</span>(<span class="st">"ENRON"</span>,<span class="op">...</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then, lookup is performed by indexing the dictionary by the desired key:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>assets[<span class="st">"037833AH4"</span>] <span class="co"># gives the General Electric Bond</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="graphs" class="level3" data-number="13.5.5">
<h3 data-number="13.5.5" class="anchored" data-anchor-id="graphs"><span class="header-section-number">13.5.5</span> Graphs</h3>
<p>A <strong>graph</strong> is a collection of nodes (also called vertices) connected by <em>edges</em> to represent relationships or connections between entities. Graphs are versatile data structures that can model exposure networks, clearing relationships, or counterparty dependencies, in addition to classics like social networks or transportation systems.</p>
<p>In Julia, a simple graph could be implemented using a dictionary where keys are nodes and values are lists of connected nodes:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Graph{T}</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    nodes<span class="op">::</span><span class="dt">Dict{T, Vector{T}}</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">add_edge!</span>(graph<span class="op">::</span><span class="dt">Graph{T}</span>, node1<span class="op">::</span><span class="dt">T</span>, node2<span class="op">::</span><span class="dt">T</span>) <span class="kw">where</span> {T}</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(<span class="fu">get!</span>(graph.nodes, node1, T[]), node2)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(<span class="fu">get!</span>(graph.nodes, node2, T[]), node1)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="fu">Graph</span>(<span class="fu">Dict</span><span class="dt">{Int, Vector{Int}}</span>())</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">add_edge!</span>(g, <span class="fl">1</span>, <span class="fl">2</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">add_edge!</span>(g, <span class="fl">2</span>, <span class="fl">3</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">add_edge!</span>(g, <span class="fl">1</span>, <span class="fl">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This implementation represents an undirected graph. For a directed graph, you would only add the edge in one direction.</p>
<p>To make graphs a bit more concrete in the financial context: an example might be in risk analytics you might treat each node as a legal entity and each edge as an exposure or collateral link. Once the network is encoded, running BFS from a failed counterparty highlights potential contagion paths; centrality measures help identify “too-connected-to-fail” hubs.</p>
<p>Graphs can be traversed using various algorithms such as depth-first search (DFS) or breadth-first search (BFS). These traversals are useful for finding paths, detecting cycles, or exploring connected components.</p>
<p>For more advanced graph operations, the <a href="https://github.com/JuliaGraphs/Graphs.jl">Graphs.jl package</a> provides a comprehensive set of tools for working with graphs in Julia.</p>
</section>
<section id="sec-data-trees" class="level3" data-number="13.5.6">
<h3 data-number="13.5.6" class="anchored" data-anchor-id="sec-data-trees"><span class="header-section-number">13.5.6</span> Trees</h3>
<p>A tree is a hierarchical data structure with a root node and child subtrees. Each node in a tree can have zero or more child nodes, and every node (except the root) has exactly one parent node. Trees are widely used for representing hierarchical relationships, organizing data for efficient searching and sorting, and in various algorithms.</p>
<p>A simple binary tree node in Julia could be implemented as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mutable struct</span> TreeNode{T}</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    value<span class="op">::</span><span class="dt">T</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    left<span class="op">::</span><span class="dt">Union{TreeNode{T}, Nothing}</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    right<span class="op">::</span><span class="dt">Union{TreeNode{T}, Nothing}</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a simple binary tree</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> <span class="fu">TreeNode</span>(<span class="fl">1</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">TreeNode</span>(<span class="fl">2</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">TreeNode</span>(<span class="fl">4</span>, <span class="cn">nothing</span>, <span class="cn">nothing</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">TreeNode</span>(<span class="fl">5</span>, <span class="cn">nothing</span>, <span class="cn">nothing</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">TreeNode</span>(<span class="fl">3</span>, </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        <span class="cn">nothing</span>, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">TreeNode</span>(<span class="fl">6</span>, <span class="cn">nothing</span>, <span class="cn">nothing</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Trees have various specialized forms, each with its own properties and use cases:</p>
<ul>
<li>Binary Search Trees (BST): Each node has at most two children, with all left descendants less than the current node, and all right descendants greater.</li>
<li>AVL Trees: Self-balancing binary search trees, ensuring that the heights of the two child subtrees of any node differ by at most one.</li>
<li>B-trees: Generalization of binary search trees, allowing nodes to have more than two children. Commonly used in databases and file systems.</li>
<li>Trie (Prefix Tree): Used for efficient retrieval of keys in a dataset of strings. Each node represents a common prefix of some keys.</li>
</ul>
<p>Trees support efficient operations like insertion, deletion, and searching, often with <span class="math inline">\(O(log n)\)</span> time complexity for balanced trees. They are fundamental in many algorithms and data structures, including heaps, syntax trees in compilers, and decision trees in machine learning.</p>
</section>
<section id="data-structures-conclusion" class="level3" data-number="13.5.7">
<h3 data-number="13.5.7" class="anchored" data-anchor-id="data-structures-conclusion"><span class="header-section-number">13.5.7</span> Data Structures Conclusion</h3>
<p>Data structures have strengths and weakness depending on whether you want to prioritize computational efficiency, memory (space) efficiency, code simplicity, and/or mutability. Due to the complexity of real world modeling needs, it can be the case that different representations of the data are more natural or more efficient for the use case at hand.</p>
<p>A good rule of thumb is to map the question to the access pattern: sequential valuation → arrays, hierarchical reporting → trees or dictionaries, network relationships → graphs. Picking the right shape for the data often matters more than micro-optimising the code.</p>
</section>
</section>
<section id="verification-and-advanced-testing" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="verification-and-advanced-testing"><span class="header-section-number">13.6</span> Verification and Advanced Testing</h2>
<section id="sec-formal-verification" class="level3" data-number="13.6.1">
<h3 data-number="13.6.1" class="anchored" data-anchor-id="sec-formal-verification"><span class="header-section-number">13.6.1</span> Formal Verification</h3>
<p>Formal verification is a technique used to prove or disprove the correctness of algorithms with respect to a certain formal specification or property. In essence, it’s a mathematical approach to ensuring that a system behaves exactly as intended under all possible conditions.</p>
<p>In formal verification, we use mathematical methods to:</p>
<ol type="1">
<li>Create a formal model of the system</li>
<li>Specify the desired properties or behaviors</li>
<li>Prove that the model satisfies these properties</li>
</ol>
<p>This process can be automated using specialized software tools called theorem provers or model checkers. In finance, formal methods appear in high-assurance corners such as core valuation libraries, exchange protocols, or regulatory reporting engines—areas where a production bug could have systemic consequences.</p>
<section id="formal-verification-in-practice" class="level4" data-number="13.6.1.1">
<h4 data-number="13.6.1.1" class="anchored" data-anchor-id="formal-verification-in-practice"><span class="header-section-number">13.6.1.1</span> Formal Verification in Practice</h4>
<p>It sounds like the perfect risk management and regulatory technique: prove that the system works exactly as intended. However, there has been very limited deployment of formal verification in industry. This is for several reasons:</p>
<ol type="1">
<li>Incomplete Coverage: It’s often impractical to formally verify entire large-scale financial systems. Verification, if at all, is typically limited to critical components.</li>
<li>Incomplete Specification: Actually reasoning through how the system should behave in all scenarios requires actually contemplating mathematically complete and rigorous possibilities that could occur.</li>
<li>Model-Reality Gap: The formal model may not perfectly represent the real-world system, especially in finance where market behavior can be unpredictable.</li>
<li>Changing Requirements: Financial regulations and market conditions change rapidly, potentially outdating formal verifications.</li>
<li>Performance Trade-offs: Systems designed for easy formal verification might sacrifice performance or flexibility.</li>
<li>Cost: The process can be expensive in terms of time and specialized labor.</li>
</ol>
</section>
</section>
<section id="property-based-testing" class="level3" data-number="13.6.2">
<h3 data-number="13.6.2" class="anchored" data-anchor-id="property-based-testing"><span class="header-section-number">13.6.2</span> Property Based Testing</h3>
<p>Testing will be discussed in more detail in <a href="software.html" class="quarto-xref"><span>Chapter 12</span></a>, but an intermediate concept between Formal Verification and typical software testing is <strong>property-based</strong> testing, which tests for general rules instead of specific examples.</p>
<p>For example, a function which is associative (<span class="math inline">\((a + b) + c = a + (b + c)\)</span>) or commutative (<span class="math inline">\(a + b\)</span> = <span class="math inline">\(b + a\)</span>) can be tested with simple examples like:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Test</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">myadd</span>(a,b) <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@test</span> <span class="fu">myadd</span>(<span class="fl">1</span>,<span class="fl">2</span>) <span class="op">==</span> <span class="fu">myadd</span>(<span class="fl">2</span>,<span class="fl">1</span>) <span class="co"># commutative</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@test</span> <span class="fu">myadd</span>(<span class="fu">myadd</span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="fl">3</span>) <span class="op">==</span> <span class="fu">myadd</span>(<span class="fl">1</span>,<span class="fu">myadd</span>(<span class="fl">2</span>,<span class="fl">3</span>)) <span class="co"># associative</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>However, we really haven’t proven the associative and commutative properties in general. There are techniques to do this, which is a more comprehensive alternative to testing specific examples above. Packages like <a href="https://github.com/Seelengrab/Supposition.jl">Supposition.jl</a> provide functionality for this. In actuarial practice you might encode invariants such as “present value is non-negative under positive discount rates” or “portfolio Greeks add up across sub-portfolios” and let the library hammer your code with random inputs. Note that like Formal Verification, property-based testing is a more advanced topic.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Property-based testing is also tied in with concepts related to types we talked about in <a href="foundations-of-programming.html#sec-number-types" class="quarto-xref"><span>Section 5.4.1</span></a>: floating point numbers are not associative when summing more than two numbers at a time: the order in which the floats get added affects the accumulated imprecision.</p>
</div>
</div>
</section>
<section id="fuzzing" class="level3" data-number="13.6.3">
<h3 data-number="13.6.3" class="anchored" data-anchor-id="fuzzing"><span class="header-section-number">13.6.3</span> Fuzzing</h3>
<p>Fuzzing is kind of like property based testing, but instead of testing general rules, we generalize the simple examples using randomness. For example, we could test the commutative property using random numbers instead, therefore statistically checking that the property holds:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@testset</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fu">rand</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="fu">rand</span>()</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@test</span> <span class="fu">myadd</span>(a,b) <span class="op">==</span> <span class="fu">myadd</span>(b,a)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This is a good advancement over the simple <code>@test myadd(1,2) == myadd(2,1)</code>, in terms of checking the correctness of <code>myadd</code>, but it comes at the cost of more computational time and non-deterministic tests. Fuzzing typically seeks to find edge-cases: crashes or unexpected behavior by exploring random/invalid inputs. It is especially useful for feeds that ingest external data (e.g., vendor trade files) where malformed records are a bigger threat than pure numerical error.</p>
</section>
</section>
<section id="sec-portfolio-complexity" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="sec-portfolio-complexity"><span class="header-section-number">13.7</span> Finance Example: Complexity and Portfolio Selection</h2>
<p>Many real portfolio decisions include discrete choices: buy or skip a lot, include or exclude an ETF, cap the number of names, or enforce minimum ticket sizes. These discrete elements quickly turn an otherwise smooth optimization into a combinatorial search.</p>
<p>Consider a simplified subset selection problem with <span class="math inline">\(n\)</span> candidate assets. Each asset <span class="math inline">\(i\)</span> has an expected return <span class="math inline">\(r_i\)</span> and a “cost” <span class="math inline">\(c_i\)</span> (e.g., capital required for a minimum lot). We wish to select a subset that maximizes total expected return subject to a budget <span class="math inline">\(B\)</span>. This is the classic 0–1 knapsack problem:</p>
<p><span class="math display">\[
\max_{x \in \{0,1\}^n} \sum_{i=1}^{n} r_i\, x_i \quad \text{subject to} \quad \sum_{i=1}^{n} c_i\, x_i \le B
\]</span></p>
<ul>
<li>Brute force enumerates all <span class="math inline">\(2^n\)</span> subsets to find the best feasible one. Complexity: <span class="math inline">\(O(2^n \cdot n)\)</span> work, so it explodes rapidly.</li>
<li>A greedy heuristic sorts by value-to-cost ratio <span class="math inline">\(r_i/c_i\)</span> and takes items while budget remains. Complexity: <span class="math inline">\(O(n \log n)\)</span>; fast, but not guaranteed optimal.</li>
<li>Branch-and-bound (B&amp;B) remains worst‑case exponential, but prunes large parts of the search using an optimistic upper bound (here, the fractional knapsack relaxation), often exploring far fewer nodes in practice.</li>
</ul>
<p>Rather than relying on wall‑clock times (which depend on your machine), we count “visited” nodes—how many partial solutions each method examines—to illustrate growth in work.</p>
<div id="20" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a synthetic instance. Pass an RNG for reproducibility.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">synth_instance</span>(rng<span class="op">::</span><span class="dt">AbstractRNG</span>, n<span class="op">::</span><span class="dt">Int</span>; budget_ratio<span class="op">::</span><span class="dt">Float64</span>=<span class="fl">0.35</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="fl">0.04</span> <span class="op">.+</span> <span class="fl">0.08</span> <span class="op">.*</span> <span class="fu">rand</span>(rng, n)            <span class="co"># expected returns in [4%, 12%]</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="fu">Float64</span>.(<span class="fu">rand</span>(rng, <span class="fl">50</span><span class="op">:</span><span class="fl">150</span>, n))          <span class="co"># costs (min lot "sizes"), as reals</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> budget_ratio <span class="op">*</span> <span class="fu">sum</span>(c)                   <span class="co"># budget as a real, not floored</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r, c, B</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Greedy heuristic: sort by value-to-cost ratio and pack until budget is exhausted.</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greedy_knapsack</span>(r<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    c<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    B<span class="op">::</span><span class="dt">Real</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(r)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    ratio <span class="op">=</span> r <span class="op">./</span> c</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> <span class="fu">sortperm</span>(ratio, rev<span class="op">=</span><span class="cn">true</span>)           <span class="co"># highest ratio first</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    cost <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    chosen <span class="op">=</span> <span class="fu">falses</span>(n)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inbounds</span> <span class="cf">for</span> i <span class="kw">in</span> idx</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cost <span class="op">+</span> c[i] <span class="op">&lt;=</span> B <span class="op">+</span> <span class="fl">1e-12</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>            chosen[i] <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> r[i]</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>            cost <span class="op">+=</span> c[i]</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total, chosen</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Brute-force: enumerate all 2^n subsets (only feasible for small n).</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">brute_force_knapsack</span>(r<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    c<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    B<span class="op">::</span><span class="dt">Real</span>)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(r)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    best <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    bestmask <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    total_subsets <span class="op">=</span> (<span class="fu">Int</span>(<span class="fl">1</span>) <span class="op">&lt;&lt;</span> n)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inbounds</span> <span class="cf">for</span> mask <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(total_subsets<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>        visited <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>        cost <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ((mask <span class="op">&gt;&gt;&gt;</span> (i <span class="op">-</span> <span class="fl">1</span>)) <span class="op">&amp;</span> <span class="bn">0x1</span>) <span class="op">==</span> <span class="fl">1</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>                value <span class="op">+=</span> r[i]</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>                cost <span class="op">+=</span> c[i]</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> cost <span class="op">&gt;</span> B</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">end</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cost <span class="op">&lt;=</span> B <span class="op">&amp;&amp;</span> value <span class="op">&gt;</span> best</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>            best <span class="op">=</span> value</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>            bestmask <span class="op">=</span> mask</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>    chosen <span class="op">=</span> <span class="fu">falses</span>(n)</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>        chosen[i] <span class="op">=</span> ((bestmask <span class="op">&gt;&gt;&gt;</span> (i <span class="op">-</span> <span class="fl">1</span>)) <span class="op">&amp;</span> <span class="bn">0x1</span>) <span class="op">==</span> <span class="fl">1</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best, chosen, visited</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Branch-and-Bound with a fractional-knapsack upper bound (optimistic).</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="co"># The upper bound relaxes x_i ∈ {0,1} to x_i ∈ [0,1] and </span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="co"># "fills" the remaining budget fractionally.</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">branch_and_bound_knapsack</span>(r<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>,</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>    c<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>,</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>    B<span class="op">::</span><span class="dt">Real</span>)</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">length</span>(r)</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> <span class="fu">Float64</span>.(r)</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>    cs <span class="op">=</span> <span class="fu">Float64</span>.(c)</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>    Bf <span class="op">=</span> <span class="fu">float</span>(B)</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>    ratio <span class="op">=</span> rs <span class="op">./</span> cs</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>    order <span class="op">=</span> <span class="fu">sortperm</span>(ratio, rev<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> rs[order]</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>    cs <span class="op">=</span> cs[order]</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>    best <span class="op">=</span> <span class="fu">Ref</span>(<span class="op">-</span><span class="cn">Inf</span>)            <span class="co"># current best objective</span></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>    best_choice <span class="op">=</span> <span class="fu">falses</span>(n)     <span class="co"># in sorted order</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> <span class="fu">Ref</span>(<span class="fl">0</span>)            <span class="co"># node counter</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    choice <span class="op">=</span> <span class="fu">falses</span>(n)          <span class="co"># current partial choice (sorted order)</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inline</span> <span class="kw">function</span> <span class="fu">ubound</span>(idx<span class="op">::</span><span class="dt">Int</span>, value<span class="op">::</span><span class="dt">Float64</span>, cost<span class="op">::</span><span class="dt">Float64</span>)</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cost <span class="op">&gt;</span> Bf</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="cn">Inf</span></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>        cap <span class="op">=</span> Bf <span class="op">-</span> cost</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>        ub <span class="op">=</span> value</span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>        <span class="pp">@inbounds</span> <span class="cf">for</span> j <span class="kw">in</span> idx<span class="op">:</span>n</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cs[j] <span class="op">&lt;=</span> cap <span class="op">+</span> <span class="fl">1e-12</span></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>                ub <span class="op">+=</span> rs[j]</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>                cap <span class="op">-=</span> cs[j]</span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>                ub <span class="op">+=</span> rs[j] <span class="op">*</span> (cap <span class="op">/</span> cs[j])     <span class="co"># fractional "fill" for bound</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ub</span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dfs</span>(idx<span class="op">::</span><span class="dt">Int</span>, value<span class="op">::</span><span class="dt">Float64</span>, cost<span class="op">::</span><span class="dt">Float64</span>)</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>        visited[] <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> idx <span class="op">&gt;</span> n</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cost <span class="op">&lt;=</span> Bf <span class="op">&amp;&amp;</span> value <span class="op">&gt;</span> best[]</span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>                best[] <span class="op">=</span> value</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>                best_choice <span class="op">.=</span> choice</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prune if even the optimistic bound cannot beat current best.</span></span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="fu">ubound</span>(idx, value, cost) <span class="op">&lt;=</span> best[] <span class="op">+</span> <span class="fl">1e-12</span></span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Branch: include item idx</span></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>        choice[idx] <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dfs</span>(idx <span class="op">+</span> <span class="fl">1</span>, value <span class="op">+</span> rs[idx], cost <span class="op">+</span> cs[idx])</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Branch: exclude item idx</span></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a>        choice[idx] <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dfs</span>(idx <span class="op">+</span> <span class="fl">1</span>, value, cost)</span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dfs</span>(<span class="fl">1</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>)</span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map best_choice back to the original indexing</span></span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>    selected <span class="op">=</span> <span class="fu">falses</span>(n)</span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inbounds</span> <span class="cf">for</span> (k, i) <span class="kw">in</span> <span class="fu">pairs</span>(order)</span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>        selected[i] <span class="op">=</span> best_choice[k]</span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best[], selected, visited[]</span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Small demonstration: brute force is feasible at n ≈ 20; </span></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a><span class="co"># for n ≈ 40 we skip brute force.</span></span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a>    rng <span class="op">=</span> <span class="fu">MersenneTwister</span>(<span class="fl">1234</span>)</span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Small instance where brute force is still possible</span></span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>    n_small <span class="op">=</span> <span class="fl">20</span></span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>    r, c, B <span class="op">=</span> <span class="fu">synth_instance</span>(rng, n_small; budget_ratio<span class="op">=</span><span class="fl">0.35</span>)</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>    bf_val, bf_sel, bf_visited <span class="op">=</span> <span class="fu">brute_force_knapsack</span>(r, c, B)</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>    bb_val, bb_sel, bb_visited <span class="op">=</span> <span class="fu">branch_and_bound_knapsack</span>(r, c, B)</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>    gr_val, gr_sel <span class="op">=</span> <span class="fu">greedy_knapsack</span>(r, c, B)</span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"n = </span><span class="sc">$</span>n_small<span class="st">"</span>)</span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" total subsets = "</span>, <span class="fl">1</span> <span class="op">&lt;&lt;</span> n_small)                 <span class="co"># 1,048,576</span></span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" brute force visited = "</span>, bf_visited,</span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">", optimal value = "</span>, bf_val)</span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" branch-and-bound visited = "</span>, bb_visited,</span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>        <span class="st">", optimal value = "</span>, bb_val)</span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" greedy value = "</span>, gr_val,</span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>        <span class="st">", optimality gap = "</span>, bf_val <span class="op">-</span> gr_val)</span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Larger instance—note how the search space explodes (2^40 ≈ 10^12)</span></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a>    n_large <span class="op">=</span> <span class="fl">40</span></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a>    r2, c2, B2 <span class="op">=</span> <span class="fu">synth_instance</span>(rng, n_large; budget_ratio<span class="op">=</span><span class="fl">0.35</span>)</span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a>    bb2_val, bb2_sel, bb2_visited <span class="op">=</span> <span class="fu">branch_and_bound_knapsack</span>(r2, c2, B2)</span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a>    gr2_val, gr2_sel <span class="op">=</span> <span class="fu">greedy_knapsack</span>(r2, c2, B2)</span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">n = </span><span class="sc">$</span>n_large<span class="st">"</span>)</span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" total subsets = "</span>, <span class="fu">BigInt</span>(<span class="fl">1</span>) <span class="op">&lt;&lt;</span> n_large)         <span class="co"># ≈ 1.1×10^12</span></span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" branch-and-bound visited = "</span>, bb2_visited,</span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a>        <span class="st">", optimal value = "</span>, bb2_val)</span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">" greedy value = "</span>, gr2_val,</span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a>        <span class="st">", optimality gap = "</span>, bb2_val <span class="op">-</span> gr2_val)</span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>n = 20
 total subsets = 1048576
 brute force visited = 1048576, optimal value = 0.7605388597519076
 branch-and-bound visited = 317, optimal value = 0.7605388597519077
 greedy value = 0.703897494058528, optimality gap = 0.05664136569337963

n = 40
 total subsets = 1099511627776
 branch-and-bound visited = 115, optimal value = 1.4909468614490333
 greedy value = 1.4909468614490333, optimality gap = 0.0</code></pre>
</div>
</div>
<p>What this shows in practice:</p>
<ul>
<li>Brute force scales as <span class="math inline">\(2^n\)</span>. At <span class="math inline">\(n=20\)</span>, there are <span class="math inline">\(1{,}048{,}576\)</span> subsets—still manageable. At <span class="math inline">\(n=40\)</span>, there are <span class="math inline">\(\approx 10^{12}\)</span> subsets—completely infeasible to enumerate.</li>
<li>Greedy is fast and often near‑optimal, especially when ratios <span class="math inline">\(r_i/c_i\)</span> align with the true optimum. However, it can be arbitrarily sub‑optimal in adversarial cases.</li>
<li>Branch‑and‑bound exploits structure. The fractional‑knapsack bound is optimistic—it assumes you could take fractions of remaining items—so any subtree whose bound cannot beat the current best is safely pruned. Worst‑case complexity remains exponential, but typical search can drop from billions of nodes to thousands or millions.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Financial Modeling Pro Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In realistic portfolio construction, practitioners frequently avoid pure subset selection by relaxing to continuous weights (e.g., mean–variance) or by formulating a mixed‑integer model and using modern MILP solvers. These solvers implement sophisticated branch‑and‑bound/branch‑and‑cut strategies, presolve, and cutting planes. When exact optimality is not essential, heuristics (greedy, local search, genetic/evolutionary methods) can deliver high‑quality portfolios quickly under operational constraints (cardinality, sector caps, turnover budgets).</p>
<p>See <a href="portfolio-optimization.html" class="quarto-xref"><span>Chapter 27</span></a> for more discussion.</p>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This topic will be covered in <a href="statistics.html" class="quarto-xref"><span>Chapter 14</span></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>“Big-O”, so named because the ‘O’ denotes the order of growth, as in <span class="math inline">\(O(1)\)</span>. <span class="math inline">\(O(n)\)</span>, etc.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The Traveling Salesperson Problem is a classic computer science problem where you need to find the shortest possible route that visits each city in a given set exactly once and returns to the starting city. It’s a seemingly simple problem that becomes computationally intensive very quickly as the number of cities increases.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In practice, the operating system may have already allocated space for an array that’s larger than what the program is actually using so far, so this step may be ‘quick’ at times, while other times the operating system may actually need to extend the block of memory allocated to the array.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./software.html" class="pagination-link" aria-label="Applying Software Engineering Practices">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Applying Software Engineering Practices</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./statistics.html" class="pagination-link" aria-label="Statistical Inference and Information Theory">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistical Inference and Information Theory</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>