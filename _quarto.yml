project:
  type: book
  output-dir: _book
  render:
    - "*.qmd"
  post-render:
    - "uv run _scripts/fix-landscape-pages.py"
engines: ['julia']
highlight-style: github
execute:
  freeze: auto  # re-render only when source changes

filters:
  - _extensions/truncate-output.lua

book:
  title: "Modern Financial Modeling"
  subtitle: "Concepts and Applications for Actuaries and Other Financial Professionals"
  author:
    - name: Alec Loudenback
    - name: Yun-Tien Lee
  date: "03/02/2026"
  cover-image: images/cover.png
  chapters:
    - index.qmd
    - copyright.qmd
    - dedication.qmd
    - purchase.qmd
    - part: intro.qmd
      chapters:
      - why-program.qmd
      - why-julia.qmd
    - part: foundations-financial.qmd
      chapters:
      - elements-of-financial-modeling.qmd
      - financial-modeling-practice.qmd
    - part: conceptual-foundations.qmd
      chapters:
      - foundations-of-programming.qmd
      - first-abstractions.qmd
      - type-abstractions.qmd
      - patterns-abstraction.qmd
    - part: conceptual-foundations2.qmd
      chapters:
      - hardware.qmd
      - performance-single.qmd
      - parallelization.qmd
    - part: computational-thinking.qmd
      chapters:
      - software.qmd
      - elements-of-compsci.qmd
      - statistics.qmd
      - stochastic.qmd
      - autodiff.qmd
      - optimization.qmd
      - visualization.qmd
      - matrices.qmd
      - data-learning.qmd
    - part: julia-development.qmd
      chapters:
      - julia-writing.qmd
      - julia-debugging.qmd
      - julia-sharing.qmd
      - julia-optimizing.qmd
    - part: applications.qmd
      chapters:
      - scenario-generation.qmd
      - similarity-calculation.qmd
      - portfolio-optimization.qmd
      - sensitivity-analysis.qmd
      - autodiff_alm.qmd
      - stochastic-mortality.qmd
      - bayesian-mortality.qmd
      - other-techniques.qmd
    - part: appendices.qmd
      chapters:
      - ecosystem.qmd
      - references.qmd
    - book-index.qmd

bibliography: references.bib

format:
  html:
    css: styles.css
    theme: 
      light: flatly
      dark: darkly
    grid: 
      margin-width: 350px
    monofont: JuliaMono
    include-in-header: 
      - text: |
          <script data-goatcounter="https://julia-fin-book.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
  pdf:
    include-before-body:
      - _copyright-page.tex
    filters:
      - _extensions/remove-pdf-chapters.lua
      - _extensions/chapter-author.lua
    documentclass: scrbook
    fontsize: 9pt
    geometry:
      - paperwidth=7in
      - paperheight=10in
      - inner=1in
      - outer=0.75in
      - top=0.875in
      - bottom=0.875in
      - twoside
    # citation-location: margin # tbl-panel broken with this turned on
    include-in-header:
      - text: |
          \renewcommand{\arraystretch}{1.15}
          \usepackage{amsmath}
          \usepackage{xcolor}
          \usepackage{imakeidx}
          \makeindex[intoc]
          \usepackage[most]{tcolorbox}
          \tcbset{before upper={\setlength{\parskip}{0.5\baselineskip plus 2pt minus 1pt}}}
          \renewenvironment{quote}
            {\begin{tcolorbox}[colback=gray!5, colframe=gray!40, boxrule=0.5pt, arc=0pt, left=10pt, right=10pt, top=8pt, bottom=8pt]\itshape}
            {\end{tcolorbox}}
          \usepackage{fvextra}
          \DefineVerbatimEnvironment{Highlighting}{Verbatim}{
            commandchars=\\\{\},
            breaklines,
            breakbefore={.([\{},
            breakafter={/)\]_-\}}
          }
          \RecustomVerbatimEnvironment{verbatim}{Verbatim}{breaklines,breakafter={/-_\}},breakanywhere}
          \usepackage{mdframed}
          \surroundwithmdframed[
            linewidth=2pt,
            linecolor=gray,
            topline=false,
            bottomline=false,
            rightline=false,
            innerleftmargin=10pt
          ]{Highlighting}
    monofont: JuliaMono
    mainfont: "TeX Gyre Pagella"
    keep-tex: true