<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.10">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Elements of Financial Modeling – Computational Thinking for Actuaries and Financial Professionals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conceptual-foundations.html" rel="next">
<link href="./why-julia.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3d3a3f531f1be4526fdd4068b34a2ee6.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a830fe05c40437511722e23bd7ea26de.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-72d77660d82bf229fd23b34cda9a9670.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script data-goatcounter="https://julia-fin-book.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Introduction</a></li><li class="breadcrumb-item"><a href="./elements-of-financial-modeling.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Elements of Financial Modeling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Thinking for Actuaries and Financial Professionals</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./why-program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Program?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./why-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Why use Julia?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elements-of-financial-modeling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Elements of Financial Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./conceptual-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conceptual Foundations: Programming and Abstractions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-of-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Elements of Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-abstractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Functional Abstractions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./type-abstractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data and Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./patterns-abstraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Higher Levels of Abstraction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./conceptual-foundations2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conceptual Foundations: Building Performant Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hardware.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hardware and Its Implications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Writing Performant Single-Threaded Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Debugging and Performance Measurement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parallelization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Parallelization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Julia Development Tips</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./computational-thinking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interdisciplinary Concepts and Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Applying Software Engineering Principles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elements-of-compsci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Elements of Computer Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Statistical Inference and Information Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autodiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Automatic Differentiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Stochastic Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Visualizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Matrices and Their Uses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Learning from Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applied Financial Modeling Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Stochastic Mortality Projections</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scenario-generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Scenario Generation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity-calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Similarity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sensitivity-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./portfolio-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Portfolio Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Bayesian Mortality Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-techniques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Other Useful Techniques</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Set up Julia and the Computing Environment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Environment and Package Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecosystem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">The Julia Ecosystem Today</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#in-this-chapter" id="toc-in-this-chapter" class="nav-link active" data-scroll-target="#in-this-chapter"><span class="header-section-number">3.1</span> In this Chapter</a></li>
  <li><a href="#what-is-a-model" id="toc-what-is-a-model" class="nav-link" data-scroll-target="#what-is-a-model"><span class="header-section-number">3.2</span> What is a model?</a>
  <ul class="collapse">
  <li><a href="#small-world-vs-large-world" id="toc-small-world-vs-large-world" class="nav-link" data-scroll-target="#small-world-vs-large-world"><span class="header-section-number">3.2.1</span> “Small world” vs “Large world”</a></li>
  </ul></li>
  <li><a href="#what-is-a-financial-model" id="toc-what-is-a-financial-model" class="nav-link" data-scroll-target="#what-is-a-financial-model"><span class="header-section-number">3.3</span> What is a <em>Financial</em> Model?</a>
  <ul class="collapse">
  <li><a href="#difference-from-data-science" id="toc-difference-from-data-science" class="nav-link" data-scroll-target="#difference-from-data-science"><span class="header-section-number">3.3.1</span> Difference from Data Science</a></li>
  </ul></li>
  <li><a href="#key-considerations-of-a-model" id="toc-key-considerations-of-a-model" class="nav-link" data-scroll-target="#key-considerations-of-a-model"><span class="header-section-number">3.4</span> Key considerations of a model</a></li>
  <li><a href="#possible-approaches-and-trade-offs" id="toc-possible-approaches-and-trade-offs" class="nav-link" data-scroll-target="#possible-approaches-and-trade-offs"><span class="header-section-number">3.5</span> Possible approaches and trade-offs</a></li>
  <li><a href="#how-to-work-with-data-that-feeds-the-models" id="toc-how-to-work-with-data-that-feeds-the-models" class="nav-link" data-scroll-target="#how-to-work-with-data-that-feeds-the-models"><span class="header-section-number">3.6</span> How to work with data that feeds the models</a></li>
  <li><a href="#sec-predictive-vs-explanatory" id="toc-sec-predictive-vs-explanatory" class="nav-link" data-scroll-target="#sec-predictive-vs-explanatory"><span class="header-section-number">3.7</span> Predictive versus Explanatory Models</a>
  <ul class="collapse">
  <li><a href="#a-historical-example" id="toc-a-historical-example" class="nav-link" data-scroll-target="#a-historical-example"><span class="header-section-number">3.7.1</span> A Historical Example</a></li>
  <li><a href="#examples-in-the-financial-context" id="toc-examples-in-the-financial-context" class="nav-link" data-scroll-target="#examples-in-the-financial-context"><span class="header-section-number">3.7.2</span> Examples in the Financial Context</a></li>
  </ul></li>
  <li><a href="#what-makes-a-good-model" id="toc-what-makes-a-good-model" class="nav-link" data-scroll-target="#what-makes-a-good-model"><span class="header-section-number">3.8</span> What makes a good model?</a>
  <ul class="collapse">
  <li><a href="#achieving-original-purpose" id="toc-achieving-original-purpose" class="nav-link" data-scroll-target="#achieving-original-purpose"><span class="header-section-number">3.8.1</span> Achieving original purpose</a></li>
  <li><a href="#usability" id="toc-usability" class="nav-link" data-scroll-target="#usability"><span class="header-section-number">3.8.2</span> Usability</a></li>
  <li><a href="#performance" id="toc-performance" class="nav-link" data-scroll-target="#performance"><span class="header-section-number">3.8.3</span> Performance</a></li>
  <li><a href="#separation-of-model-logic-and-data" id="toc-separation-of-model-logic-and-data" class="nav-link" data-scroll-target="#separation-of-model-logic-and-data"><span class="header-section-number">3.8.4</span> Separation of Model Logic and Data</a></li>
  <li><a href="#abstraction-of-modeled-systems" id="toc-abstraction-of-modeled-systems" class="nav-link" data-scroll-target="#abstraction-of-modeled-systems"><span class="header-section-number">3.8.5</span> Abstraction of Modeled Systems</a></li>
  </ul></li>
  <li><a href="#what-makes-a-good-modeler" id="toc-what-makes-a-good-modeler" class="nav-link" data-scroll-target="#what-makes-a-good-modeler"><span class="header-section-number">3.9</span> What makes a good modeler?</a>
  <ul class="collapse">
  <li><a href="#domain-expertise" id="toc-domain-expertise" class="nav-link" data-scroll-target="#domain-expertise"><span class="header-section-number">3.9.1</span> Domain Expertise</a></li>
  <li><a href="#model-theory" id="toc-model-theory" class="nav-link" data-scroll-target="#model-theory"><span class="header-section-number">3.9.2</span> Model Theory</a></li>
  <li><a href="#curiosity" id="toc-curiosity" class="nav-link" data-scroll-target="#curiosity"><span class="header-section-number">3.9.3</span> Curiosity</a></li>
  <li><a href="#rigor" id="toc-rigor" class="nav-link" data-scroll-target="#rigor"><span class="header-section-number">3.9.4</span> Rigor</a></li>
  <li><a href="#clarity" id="toc-clarity" class="nav-link" data-scroll-target="#clarity"><span class="header-section-number">3.9.5</span> Clarity</a></li>
  <li><a href="#humble" id="toc-humble" class="nav-link" data-scroll-target="#humble"><span class="header-section-number">3.9.6</span> Humble</a></li>
  <li><a href="#architecture" id="toc-architecture" class="nav-link" data-scroll-target="#architecture"><span class="header-section-number">3.9.7</span> Architecture</a></li>
  <li><a href="#planning" id="toc-planning" class="nav-link" data-scroll-target="#planning"><span class="header-section-number">3.9.8</span> Planning</a></li>
  <li><a href="#toolset" id="toc-toolset" class="nav-link" data-scroll-target="#toolset"><span class="header-section-number">3.9.9</span> Toolset</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Introduction</a></li><li class="breadcrumb-item"><a href="./elements-of-financial-modeling.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Elements of Financial Modeling</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Elements of Financial Modeling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>“Truth … is much too complicated to allow anything but approximations” - John von Neumann</p>
</blockquote>
<section id="in-this-chapter" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="in-this-chapter"><span class="header-section-number">3.1</span> In this Chapter</h2>
<p>We explain what constitutes a financial model and what are common uses of a model. We explore the key attributes of models, discuss different modeling approaches and their trade-offs, and examine how to work effectively with data that feeds your models. We also explain what makes an adept practitioner.</p>
</section>
<section id="what-is-a-model" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="what-is-a-model"><span class="header-section-number">3.2</span> What is a model?</h2>
<p>A <strong>model</strong> represents aspects of the world around us distilled down into simpler, more tractable components. It is impossible to fully capture everything that may affect the objects of our interest. We may build models for a variety of reasons, as listed in <a href="#tbl-REDCAPE" class="quarto-xref">Table&nbsp;<span>3.1</span></a>.</p>
<div id="tbl-REDCAPE" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-REDCAPE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: The REDCAPE model use framework, from “The Model Thinker” by Scott Page.
</figcaption>
<div aria-describedby="tbl-REDCAPE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>Use</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>R</strong>eason</td>
<td>To identify conditions and deduce logical implications.</td>
</tr>
<tr class="even">
<td><strong>E</strong>xplain</td>
<td>To provide (testable) explanations for empirical phenomena.</td>
</tr>
<tr class="odd">
<td><strong>D</strong>esign</td>
<td>To choose features of institutions, policies, and rules.</td>
</tr>
<tr class="even">
<td><strong>C</strong>ommunicate</td>
<td>To relate knowledge and understandings.</td>
</tr>
<tr class="odd">
<td><strong>A</strong>ct</td>
<td>To guide policy choices and strategic actions.</td>
</tr>
<tr class="even">
<td><strong>P</strong>redict</td>
<td>To make numerical and categorical predictions of future and unknown phenomena.</td>
</tr>
<tr class="odd">
<td><strong>E</strong>xplore</td>
<td>To investigate possibilities and hypotheticals.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>For example, say we want to simulate the returns for the stocks in our retirement portfolio. It would be impossible to try to build a model which would capture all of the individual people working jobs and making decisions, weather events that damage property, political machinations, etc. Instead, we try to capture certain fundamental characteristics. For example, it is common to model equity returns as cumulative pluses and minuses from random movements where those movements have certain theoretical or historical characteristics.</p>
<p>Whether we are using this model of equity returns to estimate available retirement income or replicate an exotic option price, a key aspect of the model is the <strong>assumptions</strong> used therein. For the retirement income scenario we might <em>assume</em> a healthy eight percent return on stocks and conclude that such a return will be sufficient to retire at age 53. Alternatively, we may assume that future returns will follow a stochastic path with a certain distribution of volatility and drift. These two assumption sets will produce <strong>output</strong> - results from our model that must be inspected, questioned, and understood in the context of the “small world” of the model’s mechanistic workings. Lastly, to be effective practitioners we must be able to contextualize the “small world” results within the “large world” that exists around us.</p>
<section id="small-world-vs-large-world" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="small-world-vs-large-world"><span class="header-section-number">3.2.1</span> “Small world” vs “Large world”</h3>
<p>What do we mean by “small world” vs “large world”? Say that our model is one that discounts a fixed set of future cashflows using the US Treasury rate curve. If I run my model using current rates today, and then re-run my model tomorrow with the same future cashflows and the present value of those cashflows has increased by 5% I may ask why the result has changed so much in such a short period of time! In the “small”, mechanistic world of the model I may be able to see that the rates I used to discount the cashflows with have fallen substantially. The “small world” answer is that the inputs have changed which produced a mechanical change in the output. The “large world” answer may be that the Federal Reserve lowered the Federal Funds Rate to prevent the economy from entering a deflationary recession. Of course, we can’t completely explain the relation between our model and the real world (otherwise we could capture that relationship in our model!). An effective practitioner will always try to look up from the immediate work and take stock of how the world at large <em>is</em> or <em>is not</em> reflected in the model.</p>
</section>
</section>
<section id="what-is-a-financial-model" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="what-is-a-financial-model"><span class="header-section-number">3.3</span> What is a <em>Financial</em> Model?</h2>
<p>Financial models are those used extensively to ascertain better understanding of complex contracts, perform scenario analysis, and inform market participants’ decisions related to perceived value (and therefore price). It can’t be quantified directly, but it is likely not an exaggeration that many billions of dollars is transacted each day as a result of decisions made from the output of financial models.</p>
<p>Most financial models can be characterized with a focus on the first or both of:</p>
<ol type="1">
<li>Attempting to project pattern of cashflows or obligations at future timepoints</li>
<li>Reducing the projected obligations into a current value</li>
</ol>
<p>Examples of this:</p>
<ul>
<li><p>Projecting a retiree’s savings through time (1), and determining how much they should be saving today for their retirement goal (2)</p></li>
<li><p>Projecting the obligation of an exotic option across different potential paths (1), and determining the premium for that option (2)</p></li>
</ul>
<p>Models are sometimes taken a step further, such as transforming the underlying <strong>economic view</strong> into an accounting or regulatory view (such as representing associated debits and credits, capital requirements, or associated intangible, capitalized balances).</p>
<p>We should also distinguish a financial model from a purely statistical model, where often the inputs and output data are known and the intention is to estimate relationships between variables (example: linear regressions). That said, a financial model may have statistical components and many aspects of modeling are shared between the two kinds.</p>
<section id="difference-from-data-science" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="difference-from-data-science"><span class="header-section-number">3.3.1</span> Difference from Data Science</h3>
<p>While practice and practitioners of financial modeling often substantially overlap, modeling in the sense used in this book is distinct from data science and statistics in all but the most general sense. To quickly define some terms as used in this book:</p>
<ul>
<li><strong>Statistics</strong>, or <strong>Statistical Modeling</strong> is the practice of applying procedures and probabilistic reasoning to data in order to determine relationships between things or to predict outcomes.</li>
<li><strong>Data Science</strong> includes statistical modeling but also incorporates the art and science of good data hygiene, data pipelines and pre-processing, and more programming than a pure statistician usually uses.</li>
</ul>
<p><strong>Financial Modeling</strong> is similar in the goal of modeling complex relationships or making predictions (a modeled price of an asset is simply a prediction of what its value is), however, it differs from data science in a few ways:</p>
<ul>
<li>Financial modeling generally incorporates a good deal of theory that assumes certain behaviors/relationships, instead of trying to infer those relationships from the data.</li>
<li>Financial modeling generally contains more unique ‘objects’ than a statistical model. The latter may have derived numerical relationships between data, however a financial model would have things like the concept of a company or portfolio, or sets of individually identifiable assets, or distinct actors in a system.</li>
<li>Financial modeling often involves a lot more simulation and hypothecating, while data science is focused on drawing conclusions from what data has already been observed.</li>
</ul>
<p>Nonetheless, there is substantial overlap in practice. For example, the assumption in a financial model (volatility, economic conditions, etc.) may be derived statistically from observed data. Given the overlap in topics, statistical content is sometimes covered in this book (including a from-the-ground-up view of modern Bayesian approaches in <a href="statistics.html" class="quarto-xref"><span>Chapter 15</span></a>).</p>
</section>
</section>
<section id="key-considerations-of-a-model" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="key-considerations-of-a-model"><span class="header-section-number">3.4</span> Key considerations of a model</h2>
<p>When creating a model, whether a data model, a conceptual model, or any other type, certain key considerations are generally important to include to ensure it is effective and useful. Some essential considerations include:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>Consideration</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Objective</td>
<td>Clearly define what the model aims to achieve.</td>
</tr>
<tr class="even">
<td>Boundaries</td>
<td>Specify the limits and constraints of the model to avoid scope creep.</td>
</tr>
<tr class="odd">
<td>Variables</td>
<td>Identify and define all variables involved in the model.</td>
</tr>
<tr class="even">
<td>Parameters</td>
<td>Include constants or coefficients that influence the variables.</td>
</tr>
<tr class="odd">
<td>Dependencies</td>
<td>Describe how variables interact with each other.</td>
</tr>
<tr class="even">
<td>Relationships</td>
<td>Detail the connections between different components of the model.</td>
</tr>
<tr class="odd">
<td>Inputs</td>
<td>Specify the data or resources required for the model to function.</td>
</tr>
<tr class="even">
<td>Outputs</td>
<td>Define what results or predictions the model produces.</td>
</tr>
<tr class="odd">
<td>Underlying Assumptions</td>
<td>Document any assumptions made during the model’s development to clarify its limitations and validity.</td>
</tr>
<tr class="even">
<td>Validation Criteria</td>
<td>Outline how the model’s accuracy and reliability are tested.</td>
</tr>
<tr class="odd">
<td>Performance Metrics</td>
<td>Define the metrics used to evaluate the model’s performance.</td>
</tr>
<tr class="even">
<td>Scalability</td>
<td>Ensure the model can handle increased data or complexity if needed.</td>
</tr>
<tr class="odd">
<td>Adaptability</td>
<td>Allow for adjustments or updates as new information or requirements arise.</td>
</tr>
<tr class="even">
<td>Documentation</td>
<td>Provide comprehensive documentation explaining how the model works, including algorithms, data sources, and methods.</td>
</tr>
<tr class="odd">
<td>Transparency</td>
<td>Make the model’s workings understandable to stakeholders or users.</td>
</tr>
<tr class="even">
<td>User Interface</td>
<td>Design an intuitive interface if the model is interactive.</td>
</tr>
<tr class="odd">
<td>Ease of Use</td>
<td>Ensure that the model is user-friendly and accessible to its intended audience.</td>
</tr>
<tr class="even">
<td>Ethics</td>
<td>Address any ethical concerns related to the model’s application or impact.</td>
</tr>
<tr class="odd">
<td>Regulations</td>
<td>Ensure compliance with relevant laws and regulations.</td>
</tr>
</tbody>
</table>
<p>Including these attributes helps create a robust, reliable, and practical model that effectively serves its intended purpose.</p>
</section>
<section id="possible-approaches-and-trade-offs" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="possible-approaches-and-trade-offs"><span class="header-section-number">3.5</span> Possible approaches and trade-offs</h2>
<p>Different modeling approaches come with their own sets of trade-offs. Common modeling approaches, and the inherent trade-offs, may include:</p>
<ol type="1">
<li>Statistical Models</li>
</ol>
<p>Examples: Linear regression, logistic regression</p>
<p>Trade-offs: - Simplicity vs.&nbsp;Accuracy: Statistical models are often simpler and more interpretable but may not capture complex relationships as well as more sophisticated models. - Assumptions: These models typically rely on assumptions (e.g., linearity, normality) that may not always hold true, potentially affecting their accuracy.</p>
<ol start="2" type="1">
<li>Machine Learning Models</li>
</ol>
<p>Examples: Decision trees, random forests, neural networks</p>
<p>Trade-offs: - Complexity vs.&nbsp;Interpretability: Machine learning models, especially deep learning models, can capture complex patterns but are often less interpretable. - Overfitting: More complex models risk overfitting the training data, requiring careful validation and tuning to ensure generalizability. - Data Requirements: These models often require large amounts of data to perform well, and their performance can degrade with limited or noisy data.</p>
<ol start="3" type="1">
<li>Simulation Models</li>
</ol>
<p>Examples: Monte Carlo simulations, agent-based models</p>
<p>Trade-offs: - Accuracy vs.&nbsp;Computational Expense: Simulations can model complex systems and scenarios but can be computationally expensive and time-consuming. - Detail vs.&nbsp;Generalization: High-fidelity simulations can be very detailed but might be overkill for problems where a simpler model would suffice.</p>
<ol start="4" type="1">
<li>Theoretical Models</li>
</ol>
<p>Examples: Economic models, physical models</p>
<p>Trade-offs: - Precision vs.&nbsp;Practicality: Theoretical models provide a foundational understanding but may rely on idealizations or simplifications that don’t fully capture real-world complexities. - Applicability: They may be highly accurate in specific contexts but less applicable to broader or more variable situations.</p>
<ol start="5" type="1">
<li>Hybrid Models</li>
</ol>
<p>Examples: Combining statistical and machine learning approaches, or combining theoretical and simulation models</p>
<p>Trade-offs: - Complexity vs.&nbsp;Versatility: Hybrid models aim to leverage the strengths of different approaches but can be complex to design and manage. - Integration Challenges: Combining different types of models may present challenges in integrating them effectively and ensuring consistency in their outputs.</p>
<ol start="6" type="1">
<li>Empirical Models</li>
</ol>
<p>Examples: Time series forecasting, econometric models</p>
<p>Trade-offs: - Data Dependence vs.&nbsp;Predictive Power: Empirical models rely heavily on historical data and may not perform well in scenarios where patterns change or data is sparse. - Context Sensitivity: These models can be very accurate for the specific data they are trained on but might not generalize well to different contexts or conditions.</p>
<ol start="7" type="1">
<li>Probabilistic Models</li>
</ol>
<p>Examples: Bayesian networks, probabilistic graphical models</p>
<p>Trade-offs: - Flexibility vs.&nbsp;Computational Complexity: Probabilistic models can handle uncertainty and complex relationships but often require more sophisticated computations and can be harder to implement and interpret.</p>
<ol start="8" type="1">
<li>Summary of Common Trade-offs:</li>
</ol>
<ul>
<li>Complexity vs.&nbsp;Simplicity: More complex models can capture more nuanced details but are harder to understand and manage.</li>
<li>Accuracy vs.&nbsp;Interpretability: High-accuracy models may be less interpretable, making it harder to understand their decision-making process.</li>
<li>Data Requirements: Some models require large amounts of data or very specific types of data, which can be a limitation in practice.</li>
<li>Computational Resources: More sophisticated models or simulations can require significant computational power, which may not always be feasible.</li>
</ul>
<p>Understanding these trade-offs helps in selecting the most appropriate modeling approach based on the specific needs of the problem at hand and the resources available.</p>
</section>
<section id="how-to-work-with-data-that-feeds-the-models" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="how-to-work-with-data-that-feeds-the-models"><span class="header-section-number">3.6</span> How to work with data that feeds the models</h2>
<p>Working effectively with data that feeds the models involves several key steps to ensure the data is suitable for modeling and that the model performs well. The steps may include:</p>
<ol type="1">
<li>Data Collection</li>
</ol>
<ul>
<li>Source Identification: Identify and gather data from relevant and reliable sources.</li>
<li>Data Acquisition: Use appropriate methods for collecting data, such as web scraping, surveys, sensors, or databases.</li>
</ul>
<ol start="2" type="1">
<li>Data Exploration and Understanding</li>
</ol>
<ul>
<li>Descriptive Statistics: Generate summary statistics (mean, median, standard deviation) to understand the data’s central tendencies and variability.</li>
<li>Visualization: Use plots (histograms, scatter plots, box plots) to visually inspect distributions and relationships between variables.</li>
<li>Data Profiling: Assess data quality, completeness, and consistency.</li>
</ul>
<ol start="3" type="1">
<li>Data Cleaning</li>
</ol>
<ul>
<li>Handling Missing Values: Decide how to address missing data—options include imputation, interpolation, or removing incomplete records.</li>
<li>Outlier Detection: Identify and handle outliers that may affect model performance. Outliers can be treated or removed based on their cause and impact.</li>
<li>Data Transformation: Normalize or standardize data if needed, especially if the model requires data in a specific format or scale.</li>
</ul>
<ol start="4" type="1">
<li>Feature Engineering</li>
</ol>
<ul>
<li>Feature Selection: Choose relevant features that contribute to the model’s predictive power. This may involve techniques like correlation analysis or feature importance scores.</li>
<li>Feature Creation: Create new features from existing data that might provide additional insights or improve model performance. This could include polynomial features, interaction terms, or domain-specific transformations.</li>
</ul>
<ol start="5" type="1">
<li>Data Splitting</li>
</ol>
<ul>
<li>Training and Testing Sets: Split the data into training and testing sets (and sometimes a validation set) to evaluate model performance and avoid overfitting.</li>
<li>Cross-Validation: Use cross-validation techniques (e.g., k-fold cross-validation) to assess model performance on different subsets of the data.</li>
</ul>
<ol start="6" type="1">
<li>Data Preprocessing</li>
</ol>
<ul>
<li>Scaling and Normalization: Apply techniques such as min-max scaling or z-score normalization to ensure features are on a similar scale.</li>
<li>Encoding Categorical Variables: Convert categorical variables into numerical formats using methods like one-hot encoding or label encoding.</li>
<li>Data Augmentation: For certain applications (e.g., image processing), augment the data to increase the size and variability of the dataset.</li>
</ul>
<ol start="7" type="1">
<li>Data Integration</li>
</ol>
<ul>
<li>Combining Datasets: If using multiple data sources, merge datasets carefully, ensuring consistent formats and handling discrepancies.</li>
<li>Data Alignment: Ensure that the data from different sources are aligned in terms of timing, units, and granularity.</li>
</ul>
<ol start="8" type="1">
<li>Data Storage and Management</li>
</ol>
<ul>
<li>Data Warehousing: Store data in a structured format that facilitates easy access and management, such as databases or data lakes.</li>
<li>Version Control: Track changes to datasets over time to maintain reproducibility and manage updates.</li>
</ul>
<ol start="9" type="1">
<li>Ethical Considerations</li>
</ol>
<ul>
<li>Bias and Fairness: Evaluate data for biases and ensure that the model does not perpetuate or amplify them.</li>
<li>Privacy: Protect sensitive information and comply with data privacy regulations such as GDPR or CCPA.</li>
</ul>
<ol start="10" type="1">
<li>Continuous Monitoring and Updating</li>
</ol>
<ul>
<li>Performance Monitoring: Regularly assess the model’s performance using new data and update the model as needed.</li>
<li>Data Drift: Monitor for changes in data distribution over time (data drift) and retrain the model if necessary.</li>
</ul>
<p>By following these steps, one can effectively manage data for your model, ensuring that it is clean, relevant, and capable of delivering accurate and reliable results.</p>
</section>
<section id="sec-predictive-vs-explanatory" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="sec-predictive-vs-explanatory"><span class="header-section-number">3.7</span> Predictive versus Explanatory Models</h2>
<p>Given a set of inputs, our model will generate an output and we are generally interested in its accuracy. <em>The model need not have a realistic mechanism for how the world works.</em> That is, we may primarily be interested in accurately calculating an output value without the model having any scientific, explanatory power of how different parts of the real-world system interact.</p>
<section id="a-historical-example" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="a-historical-example"><span class="header-section-number">3.7.1</span> A Historical Example</h3>
<p>Consider the classic underdog story where Copernicus overthrew the status quo when he proposed (correctly) that the earth orbited the sun instead of the other way around<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>The existing Ptolemic model used a geocentric view of the solar system in which the planets and sun orbited the Earth in perfect circles with an epicycle used to explain retrograde motion (as see in <a href="#fig-ptolemic-model" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>). Retrograde motion is the term used to describe the apparent, temporarily reversed motion of a planet as viewed from Earth when the Earth is overtaking the other planet in orbit around the sun. This was accurate enough to match the obersvational data that described the position of the planets in the sky.</p>
<div id="fig-ptolemic-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ptolemic-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/Epicycle_and_deferent.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ptolemic-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: In the Ptolemic solar model, the retrograde motion of the planets was explained by adding an epicycle to the circular orbit around the earth.
</figcaption>
</figure>
</div>
<p>Famously, Copernicus came along and said that the sun, not the Earth, should be at the center (a heliocentric model). Earth revolves around the sun! Today, we know this to be a much better description of reality than one in which the Earth arrogantly sits at the center of the universe. However the model was actually slightly <em>less</em> accurate in predicting the apparent position of the planets (to the limits of observational precision at the time)! Why would this be?</p>
<p>First, the Copernican proposal still used perfectly circular orbits with an epicycle adjustment, which we know today to be inaccurate (in favor of an elliptical orbit consistent with the theory of gravity). <em>Despite being more scientifically correct, it was still not the complete picture</em>.</p>
<p>Second, the geocentric model was already very accurate because it was essentially a Taylor-series approximation which described to sufficient observational accuracy the apparent position of the planet relative to the Earth. <em>The heliocentric model was effectively a re-parameterization of the orbital approximation.</em></p>
<p>Third, we have considered a limited criteria for which we are evaluating the model for accuracy, namely apparent position of the planets. <em>It’s not until we contemplate other observational data that the Copernican model would demonstrate greater modeling accuracy</em>: apparent brightness of the planets as they undergo retrograde motion and angular relationship of the planets to the sun.</p>
<p>For modelers today, this demonstrates a few things to keep in mind:</p>
<ol type="1">
<li>Predictive models need not have a scientific, causal structure to make accurate predictions.</li>
<li>It is difficult to capture the complete scientific inter-relationships of a system and much care and thought needs to be given in what aspects are included in our model.</li>
<li>We should look at, or seek out, additional data that is related to our model because we may accurately fit (or overfit) to one outcome while achieving an increasingly poor fit to other related variables.</li>
</ol>
<p>Striving to better understand the world is a <em>good thing to do</em> but trying to include more components into the model is not always going to help achieve our goals.</p>
</section>
<section id="examples-in-the-financial-context" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="examples-in-the-financial-context"><span class="header-section-number">3.7.2</span> Examples in the Financial Context</h3>
<section id="home-prices" class="level4" data-number="3.7.2.1">
<h4 data-number="3.7.2.1" class="anchored" data-anchor-id="home-prices"><span class="header-section-number">3.7.2.1</span> Home Prices</h4>
<p>American home prices which have a strong degree of seasonality and have the strongest prices around April of each year. We may find that including a simple oscillating term in our model captures the variability in prices <em>better</em> than if we tried to imperfectly capture the true market dynamics of home sales: supply and demand curves varying by personal (job bonus payment timing, school calendars), local (new homes built, company relocation), and national (monetary policy, tax incentives for home-ownership). In other words, one could likely predict a stable pattern like this with a model that contains a simple sinusoidal periodic component. One could likely spend months trying to build a more scientific model and not achieve as good of fit, <em>even though the latter tries to be more conceptually accurate</em>.</p>
<p>::: <img src="https://fred.stlouisfed.org/graph/fredgraph.png?g=1cVJa" id="fig-home-pricesq" class="img-fluid" alt="House prices peak around April of each year."> :::</p>
</section>
<section id="replicating-portfolio" class="level4" data-number="3.7.2.2">
<h4 data-number="3.7.2.2" class="anchored" data-anchor-id="replicating-portfolio"><span class="header-section-number">3.7.2.2</span> Replicating Portfolio</h4>
<p>Another example in the financial modeling realm: in attempting to value a portfolio of insurance contracts a <strong>replicating portfolio</strong> of hypothetical assets will sometimes be constructed<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The point of this is to create a basket of assets that can be more quickly (minutes to hours) valued in response to changing market conditions than it would take to run the actuarial model (hours to days). This is an example where the basket of assets has no ability to explain why the projected cashflows are what they are - but retains strong predictive accuracy.</p>
</section>
</section>
</section>
<section id="what-makes-a-good-model" class="level2 page-columns page-full" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="what-makes-a-good-model"><span class="header-section-number">3.8</span> What makes a good model?</h2>
<p>The answer is: <em>it depends</em>.</p>
<section id="achieving-original-purpose" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="achieving-original-purpose"><span class="header-section-number">3.8.1</span> Achieving original purpose</h3>
<p>A model is built for a specific set of reasons and therefore we must evaluate a model in terms of achieving that goal. We should not critique a model if we want to use it outside of what it was inteded to do. This includes: contents of output and required level of accuracy.</p>
<p>A model may have been created to for scenario analysis to value all assets in a portfolio to within half a percent of a more accurate, but much more computationally expensive model. If we try to add a never-before-seen asset class or use the model to order trades we may be extending the design scope of the original model.</p>
</section>
<section id="usability" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="usability"><span class="header-section-number">3.8.2</span> Usability</h3>
<p>How easy is it for someone to use? Does it require pages and pages of documentation, weeks of specialized training and an on-call help desk? <em>All else equal</em>, it is an indicator of how usable the model is by the amount of support and training. However, one may sometimes wish to create a highly capable, complex model which is known to require a high amount of experience and expertise. An analogy here might be the cockpit of a small Cessna aircraft versus a fighter jet: the former is a lot simpler and takes less training to master but is also more limited.</p>
<p><a href="#fig-parametric" class="quarto-xref">Figure&nbsp;<span>3.2</span></a> illustrates this concept and shows that if your goal is very high capability that you may need to expect to develop training materials and support the more complex model. On this view, a better model is one that is able to have a shorter amount of time and experience to acheive the same level of capability.</p>
<div id="cell-fig-parametric" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/GtFuI/src/scenes.jl:227</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div id="fig-parametric" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parametric-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="elements-of-financial-modeling_files/figure-html/fig-parametric-output-2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parametric-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Tradeoff between complexity and capability
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="performance" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="performance"><span class="header-section-number">3.8.3</span> Performance</h3>
<p>Financial models are generally not used for their awe-inspiring beauty - users are results oriented and the faster a model returns the requested results, the better. Aside from direct computational costs such as server runtime, a shorter model runtime means that one can iterate faster, test new ideas on the fly, and stay focused on the problem at hand.</p>
<p>Many readers may be familiar with the cadence of (1) try running model overnight, (2) see results failed in the morning, (3) spend day developing, (4) repeat step 1. It is preferred if this cycle can be measured in minutes instead of hours or days.</p>
<p>Of course, requirements must be considered here too: needs for high frequency trading, daily portfolio rebalancing, and quarterly valuations are different when it comes to performance.</p>
</section>
<section id="separation-of-model-logic-and-data" class="level3" data-number="3.8.4">
<h3 data-number="3.8.4" class="anchored" data-anchor-id="separation-of-model-logic-and-data"><span class="header-section-number">3.8.4</span> Separation of Model Logic and Data</h3>
<p>When business logic is embedded within data, or data inputs are spread out across multiple locations it’s tough to keep track of things. Using a spreadsheet as an example, often times it’s incredibly difficult to ascertain a model’s operation if inputs are spread out across locations on many tabs. Or if related calculations are performed in multiple locations, or if it’s not clear where the line is drawn between calculations performed in the worksheets or in macros.</p>
</section>
<section id="abstraction-of-modeled-systems" class="level3 page-columns page-full" data-number="3.8.5">
<h3 data-number="3.8.5" class="anchored" data-anchor-id="abstraction-of-modeled-systems"><span class="header-section-number">3.8.5</span> Abstraction of Modeled Systems</h3>
<p>At different times we are interested in different <strong>ladder of abstraction</strong>: sometimes we are interested in the small details, but other times we are interested in understanding the behavior of systems at a higher level.</p>
<p>Say we are an insurance company with a portfolio of fixed income assets supporting long term insurance liabilities. We might delineate different levels of abstraction like so:</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/simple_ladder.png" class="img-fluid figure-img"></p>
<figcaption>Think about moving up and down a ladder of abstraction when analyzing a problem.</figcaption>
</figure>
</div>
</div></div><div id="tbl-insurance-ladder" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-insurance-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.2: An example of the different levels of abstraction when thinking about modeling an insurance company’s assets and liabilites.
</figcaption>
<div aria-describedby="tbl-insurance-ladder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Item</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>More Abstract</td>
<td>Sensitivity of an entire company’s solvency position</td>
</tr>
<tr class="even">
<td></td>
<td>Sensitivity of a portfolio of assets</td>
</tr>
<tr class="odd">
<td></td>
<td>Behavior over time of an individual contract</td>
</tr>
<tr class="even">
<td>More granular</td>
<td>Mechanics of an individual bond or insurance policy</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>At different times, we are often interested in different aspects of a problem. In general, you start to be able to obtain more insights and a greater understanding of the system when you move up the ladder of abstraction.</p>
<p>In fact, a lot of designing a model is essentially trying to figure out where to put the right abstractions. What is the right level of detail to model this in and what is the right level of detail to expose to other systems?</p>
<p>Let us also distinguish between <strong>vertical abstraction</strong>, as described above, and <strong>horizontal abstraction</strong> which will refer to encapsulating different properties, or mechanics of components of model that effectively exist on the same level of vertical abstraction. For example, both asset and liability mechanics sit at the most granular level in <a href="#tbl-insurance-ladder" class="quarto-xref">Table&nbsp;<span>3.2</span></a>, But it may make sense in our model to separate the data and behavior from each other. If we were to do that, that would be an example of creating horizontal abstraction in service of our overall modeling goals.</p>
</section>
</section>
<section id="what-makes-a-good-modeler" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="what-makes-a-good-modeler"><span class="header-section-number">3.9</span> What makes a good modeler?</h2>
<p>A model is nothing without it’s operator, and a skilled practitioner is worth their weight in gold. What elements separate a good modeler from a mediocre modeler?</p>
<section id="domain-expertise" class="level3" data-number="3.9.1">
<h3 data-number="3.9.1" class="anchored" data-anchor-id="domain-expertise"><span class="header-section-number">3.9.1</span> Domain Expertise</h3>
<p>An expert who knows enough about all of the domains that are applicable is crucial. Imagine if someone said let’s emulate an architect by having a construction worker and an artist work together. It’s all too common for business to attempt to pair a business expert with an information technologist in the same way.</p>
<p>Unfortunately, this means that there’s generally no easy way out of learning enough about finance, actuarial science, computers, and/or programming in order to be an effective modeler.</p>
<p>Also, a word of warning for the financial analysts out there: the computer scientists may find it easier to learn applied financial modeling than the other way around since the tools, techniques, and language of problem solving is already more a more general and flexible skill-set. There’s more technologists starting banks than there are financiers starting technology companies.</p>
</section>
<section id="model-theory" class="level3" data-number="3.9.2">
<h3 data-number="3.9.2" class="anchored" data-anchor-id="model-theory"><span class="header-section-number">3.9.2</span> Model Theory</h3>
<p>If it is granted that financial modeling must involve, as the essential part, a building up of modeler’s knowledge, the next issue is to characterize that knowledge more explicitly. The modeler’s knowledge should be regarded as a theory, in the sense of Ryle’s<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> “Concept of the Mind.” Very briefly: a person who has or possesses a theory in this sense knows how to do certain things and in addition can support the actual doing with explanations, justifications, and answers to queries, about the model and it’s results<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>A financial model is rarely left in a final state. Regulatory changes, additional mechanics, sensitivity testing, market dynamics, new products, and new systems to interact with force a model to undergo change and development through its entire life. And like a living thing, it must have nurturing caregivers. This metaphor sounds extended, but Naur’s point is that unless the model also lives in the heads of it’s developers then it cannot successfully be maintained through time:</p>
<blockquote class="blockquote">
<p>The conclusion seems inescapable that at least with certain kinds of large programs, the continued adaption, modification, and correction of errors in them, is essentially dependent on a certain kind of knowledge possessed by a group of programmers who are closely and continuously connected with them.</p>
</blockquote>
<p>Assume that we need to adapt the model to fit a new product. One possessing a high degree of model theory includes:</p>
<ul>
<li><p>the ability to describe the trade-offs between alternate approaches that would accomplish the desired change</p></li>
<li><p>relate the proposed change to the design of the current system and any challenges that will arise as a result of prior design decisions</p></li>
<li><p>provide a quantitative estimation for the impact the change will have: runtime, risk metrics, valuation changes, etc.</p></li>
<li><p>Analogize how the system works to themselves or to others</p></li>
<li><p>Describe key limitations that the model has and where it is most divorced from the reality it seeks to represent.</p></li>
</ul>
<p>Abstractions and analogies of the system are a critical aspect of model theory, as the human mind cannot retain perfectly precise detail about how the system works in each sub-component. The ability to, at some times, collapse and compartmentalize parts of the model to limit the mental overload while at others recall important implementation details requires training - and is enhanced by learning concepts like those which will be covered in this book.</p>
<p>An example of how the right abstractions (and language describing those abstractions) can be helpful in simplifying the mental load:</p>
<p>Instead of:</p>
<p><em>The valuation process starts by reading an extract into three tabs of the spreadsheet. A macro loops through the list of policies on the first tab and in column C it gives the name of the applicable statutory valuation ruleset. The ruleset is defined as the combination of (1) the logic in the macro in the “Valuation” VBA module with, (2) the underlying rate tables from the tabs named XXX to ZZZ, along with (3) the additional policy level detail on the second tab. The valuation projection is then run with the current policy values taken from the third tab of the spreadsheet and the resulting reserve (equal to the actuarial present value of claims) is saved and recorded in column J of the first tab. Finally, a pivot table is used to sum up the reserves by different groups.</em></p>
<p>We could instead design the process so that the following could be said instead:</p>
<p><em>Policy extracts are parsed into a <code>Policy</code> datatype which contains a subtype <code>ValuationKind</code> indicating the applicable statutory ruleset to apply. From there, we map the <code>valuation</code> function over the set of <code>Policy</code>s and perform an additive reduce to determine the total reserve.</em></p>
<p>There are terminologies and concepts in the second example which we will develop over the course of this section of the book - we don’t want to dwell on the details bright now. However, we do want to emphasize that the process itself being able to condensed down to descriptions that are much more meaningful to the understanding of the model is a key differentiator for a code-based model instead of spreadsheets. It is not exaggerating that we could develop a handful of compartmentalized logics such that our primary valuation process described above could look like this in real code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>policies <span class="op">=</span> <span class="fu">parse</span>(Policy,CSV.<span class="fu">File</span>(<span class="st">"extract.csv"</span>)) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>reserve <span class="op">=</span> <span class="fu">mapreduce</span>(<span class="op">+</span>,value,policies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We’ve abstracted the mechanistic workings of the model into concise and meaningful symbols that not only perform the desired calculations but also make it obvious to an informed but unfamiliar reader what it’s doing.</p>
<p><code>parse</code> , <code>mapreduce</code>, <code>+</code> , <code>value</code> , <code>Policy</code> are all imbued with meaning - the first three would be understood by any computer scientist by the nature of their training (and is training that this book covers). The last two are unique to our model and have “real world” meaning that our domain expert modeler would understand which analogizes very directly to the way we would suggest implementing the details of <code>value</code> or <code>Policy</code>. The benefit of this, again, is to provide tools and concepts which let us more easily develop model theory.</p>
</section>
<section id="curiosity" class="level3" data-number="3.9.3">
<h3 data-number="3.9.3" class="anchored" data-anchor-id="curiosity"><span class="header-section-number">3.9.3</span> Curiosity</h3>
<p>A model never answers all of the questions and many times find itself overdrawn: sometimes more questions arise then answers provided. It is our experience that you modeler who continues to pursue questions that arise as a result of the analysis and in particular possesses an Insatiable itch for resolving apparent contradictions in model conclusions. That is, if an incomplete understanding or an incorrect model allows one to arrive at contradictory conclusions it’s suggest that a deeper understanding or model revision is required.</p>
</section>
<section id="rigor" class="level3" data-number="3.9.4">
<h3 data-number="3.9.4" class="anchored" data-anchor-id="rigor"><span class="header-section-number">3.9.4</span> Rigor</h3>
<p>When developing a model it’s important to ensure that assumptions and parameters are very clear, the methodology is in line with establish theory, inappropriate thought has been given to how the model will be used. Additionally one should be mindful of standards of practice. For example, professional actuarial societies have a long list of Actuarial Standards of Practice (“ASOPs”), some of which apply to modeling and the use of data that models ultimately rely on.</p>
</section>
<section id="clarity" class="level3" data-number="3.9.5">
<h3 data-number="3.9.5" class="anchored" data-anchor-id="clarity"><span class="header-section-number">3.9.5</span> Clarity</h3>
<p>A rigorous understanding of the fundamentals is important as it is all too easy to let imprecise communication and terminology interfere with the task at hand. Many terms in finance are overloaded with multiple meanings depending on the context such as the speakers background or company norms. When there is a term that is prone to misunderstanding because of its multiple overloaded meanings, a practitioner should take care to use that term And convey which definition is intended either explicitly or through the appropriate context clues.</p>
</section>
<section id="humble" class="level3" data-number="3.9.6">
<h3 data-number="3.9.6" class="anchored" data-anchor-id="humble"><span class="header-section-number">3.9.6</span> Humble</h3>
<p>Irreducible &amp; epistemic/reducible uncertainty…</p>
</section>
<section id="architecture" class="level3" data-number="3.9.7">
<h3 data-number="3.9.7" class="anchored" data-anchor-id="architecture"><span class="header-section-number">3.9.7</span> Architecture</h3>
<p>Any sufficiently complex project benefits from architectural thinking. Data should be separate from the logic and the model itself should not contain any substantial datum itself - instead dynamically load data from appropriate data stores and leave the “model” as the implementation of data <em>types</em> and algorithms.</p>
</section>
<section id="planning" class="level3" data-number="3.9.8">
<h3 data-number="3.9.8" class="anchored" data-anchor-id="planning"><span class="header-section-number">3.9.8</span> Planning</h3>
<p>When tackling a large problem, it helps</p>
</section>
<section id="toolset" class="level3" data-number="3.9.9">
<h3 data-number="3.9.9" class="anchored" data-anchor-id="toolset"><span class="header-section-number">3.9.9</span> Toolset</h3>
<p>An experience professional is aware of a number of approaches that can be used in solving a problem. From heuristics that are able to be calculated on a napkin to complex economic models, the ability to draw on a wide tool set allows a practitioner to find the right solution for a given problem. Further, it is the intention of this book to enumerate a number of additional approaches that may prove useful in practice.</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Prof.&nbsp;Richard Fitzpatrick has excellent coverage of the associated mathematics and implications in “A Modern Almagest”: <a href="https://farside.ph.utexas.edu/books/Syntaxis/Almagest/Almagest.html" class="uri">https://farside.ph.utexas.edu/books/Syntaxis/Almagest/Almagest.html</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>See, e.g., SOA Investment Symposium March 2010. <em>Replicating Portfolios in the Insurance Industry</em> (Curt Burmeister Mike Dorsel Patricia Matson)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Ryle, G. The Concept of Mind. Harmondsworth, England, Penguin, 1963, first published 1949. Applying “Theory Building”<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The idea of “model theory” is adapted from Peter Naur’s 1985 essay, “Programming as Theory Building”. Indeed, this whole paragraph is only a slightly modified version of Naur’s description of theory in the programming context.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./why-julia.html" class="pagination-link" aria-label="Why use Julia?">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Why use Julia?</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conceptual-foundations.html" class="pagination-link" aria-label="Conceptual Foundations: Programming and Abstractions">
        <span class="nav-page-text">Conceptual Foundations: Programming and Abstractions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>