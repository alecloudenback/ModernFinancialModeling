<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.19">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yun-Tien Lee">

<title>27&nbsp; Portfolio Optimization – Modern Financial Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sensitivity-analysis.html" rel="next">
<link href="./similarity-calculation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-89cddb112380b3222562b561b148d341.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6676cd3960b693ed4def72822e27c662.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-89cddb112380b3222562b561b148d341.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c73cb6f143af7d293445ded181288920.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-af9ca95a853921f2d6dd1819e446de5d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-c73cb6f143af7d293445ded181288920.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script data-goatcounter="https://julia-fin-book.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./applications.html">Applied Financial Modeling Techniques</a></li><li class="breadcrumb-item"><a href="./portfolio-optimization.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Portfolio Optimization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modern Financial Modeling</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./why-program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Program?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./why-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Why use Julia?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./foundations-financial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations: Effective Financial Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elements-of-financial-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Elements of Financial Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial-modeling-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Practice of Financial Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./conceptual-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations: Programming and Abstractions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-of-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Elements of Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-abstractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Functional Abstractions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./type-abstractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data and Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./patterns-abstraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Higher Levels of Abstraction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./conceptual-foundations2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations: Building Performant Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hardware.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hardware and Its Implications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Writing Performant Single-Threaded Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parallelization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Parallelization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./computational-thinking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interdisciplinary Concepts and Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Applying Software Engineering Practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elements-of-compsci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Elements of Computer Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistical Inference and Information Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Stochastic Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autodiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Automatic Differentiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Matrices and Their Uses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Learning from Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./julia-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Developing in Julia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Writing Julia Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Troubleshooting Julia Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-sharing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Distributing and Sharing Julia Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./julia-optimizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimizing Julia Code</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applied Financial Modeling Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scenario-generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Scenario Generation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./similarity-calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Similarity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./portfolio-optimization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Portfolio Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sensitivity-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autodiff_alm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Auto-differentiation and Asset Liability Management (AAD &amp; ALM)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stochastic-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Stochastic Mortality Projections</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Bayesian Mortality Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-techniques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">More Useful Techniques</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecosystem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">The Julia Ecosystem Today</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview"><span class="header-section-number">27.1</span> Chapter Overview</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">27.2</span> The Data</a></li>
  <li><a href="#theory" id="toc-theory" class="nav-link" data-scroll-target="#theory"><span class="header-section-number">27.3</span> Theory</a></li>
  <li><a href="#mathematical-tools" id="toc-mathematical-tools" class="nav-link" data-scroll-target="#mathematical-tools"><span class="header-section-number">27.4</span> Mathematical tools</a>
  <ul class="collapse">
  <li><a href="#mean-variance-optimization-model" id="toc-mean-variance-optimization-model" class="nav-link" data-scroll-target="#mean-variance-optimization-model"><span class="header-section-number">27.4.1</span> Mean-variance optimization model</a></li>
  <li><a href="#efficient-frontier-analysis" id="toc-efficient-frontier-analysis" class="nav-link" data-scroll-target="#efficient-frontier-analysis"><span class="header-section-number">27.4.2</span> Efficient frontier analysis</a></li>
  <li><a href="#black-litterman" id="toc-black-litterman" class="nav-link" data-scroll-target="#black-litterman"><span class="header-section-number">27.4.3</span> Black-Litterman</a></li>
  <li><a href="#risk-parity" id="toc-risk-parity" class="nav-link" data-scroll-target="#risk-parity"><span class="header-section-number">27.4.4</span> Risk Parity</a></li>
  <li><a href="#sharpe-ratio-maximization" id="toc-sharpe-ratio-maximization" class="nav-link" data-scroll-target="#sharpe-ratio-maximization"><span class="header-section-number">27.4.5</span> Sharpe Ratio Maximization</a></li>
  <li><a href="#robust-optimization" id="toc-robust-optimization" class="nav-link" data-scroll-target="#robust-optimization"><span class="header-section-number">27.4.6</span> Robust Optimization</a></li>
  <li><a href="#asset-weights-from-different-methodologies" id="toc-asset-weights-from-different-methodologies" class="nav-link" data-scroll-target="#asset-weights-from-different-methodologies"><span class="header-section-number">27.4.7</span> Asset weights from different methodologies</a></li>
  </ul></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations"><span class="header-section-number">27.5</span> Practical considerations</a>
  <ul class="collapse">
  <li><a href="#fractional-purchases-of-assets" id="toc-fractional-purchases-of-assets" class="nav-link" data-scroll-target="#fractional-purchases-of-assets"><span class="header-section-number">27.5.1</span> Fractional purchases of assets</a></li>
  <li><a href="#large-number-of-assets" id="toc-large-number-of-assets" class="nav-link" data-scroll-target="#large-number-of-assets"><span class="header-section-number">27.5.2</span> Large number of assets</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./applications.html">Applied Financial Modeling Techniques</a></li><li class="breadcrumb-item"><a href="./portfolio-optimization.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Portfolio Optimization</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-portfolio-optimization" class="quarto-section-identifier"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Portfolio Optimization</span></span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yun-Tien Lee </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>“Portfolio optimization is not about finding the perfect mix, but about managing risk and return in a way that aligns with your goals and circumstances.” — Unknown</p>
</blockquote>
<section id="chapter-overview" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="chapter-overview"><span class="header-section-number">27.1</span> Chapter Overview</h2>
<p>Optimization in a portfolio context with examples of asset selection under different constraints and objectives.</p>
</section>
<section id="the-data" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="the-data"><span class="header-section-number">27.2</span> The Data</h2>
<div id="4" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>μ <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.12</span>] <span class="co"># returns</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Σ <span class="op">=</span> [<span class="fl">0.1</span> <span class="fl">0.05</span> <span class="fl">0.03</span>;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.05</span> <span class="fl">0.12</span> <span class="fl">0.04</span>;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.03</span> <span class="fl">0.04</span> <span class="fl">0.08</span>] <span class="co"># covariances</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>nₐ <span class="op">=</span> <span class="fu">length</span>(μ) <span class="co"># number of assets</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3</code></pre>
</div>
</div>
</section>
<section id="theory" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="theory"><span class="header-section-number">27.3</span> Theory</h2>
<p>Harry Markowitz introduced the modern portfolio theory in 1952. The main idea is that investors are pursuing to maximize their expected return of a portfolio given a certain amount of risk. Under standard assumptions, achieving higher expected returns typically requires accepting higher risk; portfolios that simultaneously deliver higher return and lower risk are dominated and lie above the feasible set. The efficient frontier traces the best achievable trade-off.</p>
</section>
<section id="mathematical-tools" class="level2" data-number="27.4">
<h2 data-number="27.4" class="anchored" data-anchor-id="mathematical-tools"><span class="header-section-number">27.4</span> Mathematical tools</h2>
<section id="mean-variance-optimization-model" class="level3" data-number="27.4.1">
<h3 data-number="27.4.1" class="anchored" data-anchor-id="mean-variance-optimization-model"><span class="header-section-number">27.4.1</span> Mean-variance optimization model</h3>
<p>Mean-variance optimization is a mathematical framework that seeks to maximize expected returns while minimizing portfolio variance (or standard deviation). It involves calculating the expected return and risk of individual assets and finding the optimal combination of assets to achieve the desired risk-return tradeoff.</p>
<p><span class="math display">\[
\begin{aligned}
\text{minimize} \quad &amp;{w}^{T}\Sigma{w}\\
\text{subject to} \quad &amp;{r}^{T}{w}\geq{\mu}_{\text{target}}\\
&amp;{1}^{T}{w}={1}\\
&amp;{w}\geq{0}
\end{aligned}
\]</span></p>
<div id="6" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective: minimize portfolio variance</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Min, <span class="fu">dot</span>(w, Σ <span class="op">*</span> w))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># May also add additional constraints</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># target_return = 0.1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># @constraint(model, dot(μ, w) &gt;= target_return)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the optimization problem</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>w_opt <span class="op">=</span> <span class="fu">value</span>.(w)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Optimal minimum variance portfolio weights:"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, w_i) <span class="kw">in</span> <span class="fu">enumerate</span>(w_opt)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Asset "</span>, i, <span class="st">": "</span>, <span class="fu">round</span>(w_i, digits<span class="op">=</span><span class="fl">4</span>))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

Optimal minimum variance portfolio weights:
Asset 1: 0.3333
Asset 2: 0.1667
Asset 3: 0.5</code></pre>
</div>
</div>
<p>In mean-variance portfolio optimization, incorporating a cost of risk-based capital on assets is a practical consideration that reflects the additional capital required to support riskier assets in a portfolio. This approach ensures that the optimization process not only maximizes returns relative to risk but also considers the regulatory or internal cost implications associated with holding riskier assets.</p>
<p><span class="math display">\[
\begin{aligned}
\text{maximize} \quad &amp;{w}^{T}R_{adj}\\
\text{subject to} \quad &amp;{w}^{T}\Sigma{w}\le\sigma^2_{max}\\
&amp;{1}^{T}{w}={1}\\
&amp;{w}\geq{0}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(R_{adj} = [(\mu_1 - \lambda_1), (\mu_2 - \lambda_2), ..., (\mu_N - \lambda_N)]\)</span> is the adjusted expected returns.</p>
<div id="8" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>λ <span class="op">=</span> [<span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>]  <span class="co"># RBC cost per asset</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> μ <span class="op">.-</span> λ <span class="co"># risk adjusted returns</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>σ²_max <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># maximum portfolio variance</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective: minimize portfolio variance</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Max, <span class="fu">dot</span>(r, w))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of allowable portfolio variance is limited</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">dot</span>(w, Σ <span class="op">*</span> w) <span class="op">&lt;=</span> σ²_max)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># May also add additional constraints</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># target_return = 0.1</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># @constraint(model, dot(μ, w) &gt;= target_return)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the optimization problem</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>w_opt <span class="op">=</span> <span class="fu">value</span>.(w)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Optimal portfolio weights with RBC-adjusted returns:"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, w_i) <span class="kw">in</span> <span class="fu">enumerate</span>(w_opt)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Asset "</span>, i, <span class="st">": "</span>, <span class="fu">round</span>(w_i, digits<span class="op">=</span><span class="fl">4</span>))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal portfolio weights with RBC-adjusted returns:
Asset 1: 0.1667
Asset 2: 0.8333
Asset 3: 0.0</code></pre>
</div>
</div>
</section>
<section id="efficient-frontier-analysis" class="level3" data-number="27.4.2">
<h3 data-number="27.4.2" class="anchored" data-anchor-id="efficient-frontier-analysis"><span class="header-section-number">27.4.2</span> Efficient frontier analysis</h3>
<p>The efficient frontier represents the set of portfolios that offer the highest expected return for a given level of risk or the lowest risk for a given level of return. Efficient frontier analysis involves plotting risk-return combinations for different portfolios and identifying the optimal portfolio on the frontier.</p>
<div id="10" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span>, <span class="bu">CairoMakie</span>, <span class="bu">LinearAlgebra</span>, <span class="bu">MathOptInterface</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define objective function: minimize portfolio variance</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Min, <span class="fu">dot</span>(w, Σ <span class="op">*</span> w))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a range of target returns</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>target_returns <span class="op">=</span> <span class="fu">range</span>(<span class="fu">minimum</span>(μ), <span class="fu">maximum</span>(μ), length<span class="op">=</span>points)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>efficient_frontier <span class="op">=</span> <span class="fu">Vector</span><span class="dt">{Tuple{Float64,Float64}}</span>()</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> target_return <span class="kw">in</span> target_returns</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add additional constraint for target return</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@constraint</span>(model, c, <span class="fu">dot</span>(μ, w) <span class="op">==</span> target_return)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Solve the problem</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">optimize!</span>(model)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show solution</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">termination_status</span>(model) <span class="kw">in</span> (MathOptInterface.LOCALLY_SOLVED, MathOptInterface.OPTIMAL)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(efficient_frontier, (<span class="fu">sqrt</span>(<span class="fu">objective_value</span>(model)), target_return))</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unregister</span>(model, <span class="op">:</span>c)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">delete</span>(model, c)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Efficient Frontier</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>], xlabel<span class="op">=</span><span class="st">"Portfolio Volatility (σ)"</span>, ylabel<span class="op">=</span><span class="st">"Expected Return (μ)"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines!</span>(<span class="fu">map</span>(x <span class="op">-&gt;</span> x[<span class="fl">1</span>], efficient_frontier), <span class="fu">map</span>(x <span class="op">-&gt;</span> x[<span class="fl">2</span>], efficient_frontier), color<span class="op">=:</span>dodgerblue, linewidth<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<img width="672" height="480" style="object-fit: contain; height: auto;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAYAAAB6jN80AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAIABJREFUeAHswQd8FPTh///X5T7ZCWRAJgkkNuwEIgmyRaQiuL9WEUSrWEGxtLYgaCNI7ZBHLVa09ltH1Tqw1FkVFVFBCXuTMDRAIEAmIZA97/5Nvn/4JYiCkAt3l/fzaez/hYiIiIhIGzGIiIiIiLQhg4iIiIhIGzKIiIiIiLQhg4iIiIhIGzKIiIiIiLQhg4iIiIhIGzKIiIiIiLQhg4iIiIhIGzKIiIiIiLQhg4iIiIhIGzKIiIiIiLQhg4iIiIhIGzKIiIiIiLQhg4iIiIhIGzLIGf3tb38jIyODbt26ISIiItKe7d+/n8TERKZNm8a5MsgZrV27ln379tGxY0ekdVRWVuLl5YUxBhFxbdXV1Xh4eODl5YWIuLba2lpsNhs+Pj58l4yMDCoqKpg2bRrnyiBnFB8fT3x8PPPmzUNaR1FREQEBAfj6+iIirq2kpARjDIGBgYiIaysrK6O+vp7g4GC+y7x58zhfBhERERGRNmQQEREREWlDBhERERGRNmQQEREREWlDBhERERGRNmQQEREREWlDBhERERGRNmQQEREREWlDBhERERGRNmQQEREREWlDBhERERGRNmQQEREREWlDBhERERGRNmQQEREREWlDBhERERGRNmQQEREREZdU2wC7j0BmEfTqBMkRuASDiIiIiDi9ehvsK4GMQsgohIxCyCiAmgaaTO4PyRG4BIOIiIiIOJWKOthVBBmFkFkImUWw5yjU22jBaoHuodC3M6RG4TIMIiIiInLBVNTCziOQUQgZBZBRCPtKoMFOC8YDEkIgMQwSwyExDPp0Bj9PXI5BRERERNpEeS1kFkJGIWQUQkYhZJeAnZaMB/TtDH3DoG9nSAyDXp3B24pbMIiIiIhIqyuvhcxCyCiEjELIKITsErDTkpcVenWCvmGQGAZ9w6BnKHhacVsGERERETkv5bWQWQQZBZBRCBmFkF0CdlrytkKvzpAYBolhkBgG3UPBeNCuGERERETkrJXXQmYRZBRARiFkFML+Y2Cz04KXFXp3hsQwSAyDxDDoHgrGg3bPICIiIiKnVVkHO4tgeyFsL4DtBZB9DGx2WvCyQq9OkBgGiWGQFA7dQ8F4IKdhEBERERFqGmBnEWQUwPZC2F4Ae45Cg50WvKzQqxMkhkFiGCSGQ49QMB7IWTKIiIiItDP1NthXAhmFkFEIGYWwvQBqG2jBeEBCMCSGQWI4JIZBUjh4W5HzYBARERFxY/U2yDoKGQWwvRC2F8CuI1DbQAtWC/QIhaRwSAqDxHDo3Rm8rUgrM4iIiIi4CTuQXQIZhbCtALYVwI5CqKqnBQ8LXBQMSeGQFA5JYdC7M/h5Im3AICIiIuKicssgoxC2FcC2AtheAKU1fEvXjpAUDv3CITEc+naGAC/kAjGIiIiIuICyGthdDBmFsDEX1h+Gokq+JcwfEsMgMQwSwyA5AkL9ECdiEBEREXEyFXWQUQjbC2BrPmwrgEOlfEuQDySFQb8ISAqHpDCICECcnEFERETkAqq3we4jsLUAthXAtnzYcxQa7LTg7wl9wyApHJLCoV84dO2IuCCDiIiISBvKPgbb8mFbAWwtgJ1FUF1PC8YDEjtD/whICod+4fCjELBaEDdgEBEREXGQ0hrYXgAbciGjELbmQ3EV3xLmD4lhkBoFKVGQGAY+BnFTBhEREZFWUG+DXUdgQy5kFEBGIew5CnZaCvOHxDBIDIPEMLg4EkJ8kXbEICIiIvID2eywtwS25MO2fNiSD18XQ72NFvy9ICkM+kdA/3BICoeoQKSdM4iIiIicQVElbMuHjELIKIRNeXCsmhasFkgIgcQwSAyH1Cjo0xk8LIi0YBARERFppqoeMgpgWwFsyYct+ZBbxrdEB0JyBPSPgP4R0DcMfA0iZ2QQERGRdssOZJfAlnzYmg+b82H3Eai30UKgN/QLh+QI6BcO/SOgsx8i58QgIiIi7UZpDWzJh635sDkftubDsWpaMB7QpzNcHAn9wiE5AuKDwcOCSKswiIiIiFtqsMPeo5BRCBmFsDEXdhSBzU4LYf6QGAaJYZAYBgOjoYM3Ig5jEBEREbdwpBI258PmPNiSB9sLobKOFrytkBgOyRGQHAHJERAViEibMoiIiIjLqbfBriOwOQ8258PmPMg5zrd0C4LkCEiOgP4R0KczGA9ELiiDiIiIOL3iSticD5vzYFMebC+Aqnpa8PeCfuEwIBKSIyA5AkJ8EXE6BhEREXEqDXbYexQyCmFjLmzIhT1HwU5LYf6QGgUpUZAYBv3DwdOKiNMziIiIyAVVUg2b82BzHmzMhe2FUFlHC/6ekBQOKVGQHAHJERDii4hLMoiIiEibsQN7j8LmPNiQB5vzYO9RsNNSfDAkR0ByBKREQfdQsFoQcQsGERERcZjKOtheABtyYXM+bM6DY9W04GMgKRxSImFAJFwcCSG+iLgtg4iIiLSa3DLYmAeb82BTHuwsgnobLUQEwIBIGBAJF0dCYhgYD0TaDYOIiIickwY7fFMMGw7DxjzYkAu5ZbRgPKBvGKREwsWRkBoFUYGItGsGEREROStV9bAtH9bnwqZc2JgH5bW00NEbLo6EAZGQEgX9wsHPExFpxiAiIiKndaQStubDxjzYkAvbC6C2gRbC/CE1ClKiIDUK+nQGDwsi8j0MIiIigh3YexQ25MLGXNiYB/uP0YLxgKRwSImE1ChIiYIwf0TkBzKIiIi0Q/U22FEEG3Jh/WHYmAvFVbTg7wUDIiAlClKjoH8E+HkiIufJICIi0g5U1cPWfFh3GDbkwpY8qKijhXB/uCQaUqIgNQp6dAKrBRFpZQYRERE3VFELW/JhQy5szIP1h6G2gRZiO0JKJKRGQ0okdA9FRNqAQURExA3kl8O6w7D+MKzPhaxisPP/GA9ICofUKBgYBalREOqHiFwABhERERd0sBTWHYZ1h2B9Luw/Rgs+BvpHwMAoSI2GAZHg74mIOAGDiIiIC9hbAusPw7rDsO4w5JbRQoAXpEbBwGi4JBqSwsDTiog4IYOIiIgTyjkO6Qdhw2FYexhyy2jB3wuSI2BYDKREQXIEGA9ExAUYRERELjA7sPsIrD0Eaw7B+sNQUk0Lnf3gkmgYGA2DukD3ULAgIq7IICIi0sbswNdHYM0hWHMI1h+GkmpaiAqES6Lhkmi4JBrigxERN2EQERFpAznHIf0gpOfAmkNwtIoWwvwhNQqGxUJKJHQPRUTclEFERKSV2YGvj8Daw7DmEKw/DEeraCE6EAZ1gcFdYFAXiOmAiLQTBhERkVawrwRWH4I1B2HNISiuooWoQBjcBQZ3gUFdIKYDItJOGURERM7B4TJYfRBW7PVnQ4EnBRW0EBUIg7vAoC4wuAvEdEBEpIlBRETkLBRXwtrDkJ4DG3Ih6yj/Py8ahfrCoC6QEgWpUZAYhojIaRlEREROo7QG1hyCVQdh9UHIOkoLHb1hUBfoF1LJ4C52kmP9sSAicmYGERGR/6ptgE15kJ4Dqw7C9gJosHOSvyekRsOQLjAkBnp3BqsFSkpqMMZgQUTk7BhERKRdstlhZxGkH4RVObAhF6rqOcnTCqkRMDQWhnSB/hFgPBAROW8GERFpN3KOQ/pB2HAYVh2EggpaiO0Iw2JgWCxc2hUCvBARaXUGERFxW8drYFUOfJUD6TlwsJQWYjrAsFgYGgNDYiDUFxERhzOIiIjbqLfB5jxYmQMrc2B7ATTYOSnEF4Z0gaGxMCwGYjsiItLmDCIi4tKyj8HKHFh5AFYfgvJaTvKywiVRMDwWRsRC787gYUFE5IIyiIiISymtgVUH4asDsDIHDpbSQkIIjOgKw2Phkmjw80RExKkYRETEqdnskFkIXx6AFQdgSx402DkpxBeGxcDwrjA8FiIDEBFxagYREXE6xVWw8gCsOABf5UBxJSd5WiE1EkbEwoiu0KczeFgQEXEZBhERueAa7LCzCNJz4LNs2JwHNjsnxXSA4bEwLBZGxEKgNyIiLssgIiIXRGEFrNgPXx6AlTlwvIaTfAxcEg0ju8HIrhAfjIiI2zCIiEibsNlhWwF8kQ3L90NmIdj5f+KDYWRXuLQbDIoGH4OIiFsyiIiIw5TWwFc58EU2rDgAxZWc5GtgSAxc1g1GdoOYDoiItAsGERFpVTnH4bNs+Dwb1h2GugZO6tIBRsTCsFgY2Q38PRERaXcMIiJyXmobYO1hWLYPvsiGQ6WcZDxgUBe4PA4u6wYJIYiItHsGERH5wUqqYfl+WLYPvjwAFbWcFOoHo7rBZd1gRCwEeiMiIs0YRETkrOwrgWX74PNs2JgLDXZO6t0ZRsfB5XGQFA4eFkRE5DsYnFR9fT0vvPACGzduJCEhgSlTphAcHMyZvPjiiyQkJDB8+HBOp6ioiOnTp/Piiy/i5+eHiMh3abDDziL4bB8syYKso5xkPCAlEkbHwZU/grggRETkLBmc1MSJE9m2bRu33norH3zwAYsWLWLt2rX4+vryXXJyckhLS+Pxxx9n+PDhnM7kyZP58MMP+fvf/46fnx8iIs1V18PKHFi6Fz7bByXVnBTsA5d1gx/Hw6Vdwd8LERE5BwYntH37dt5++2327dtH165dmTlzJt27d+ftt99m0qRJnKq0tJTLL7+cbdu2UVdXx3d5+umnycjIQESkueM18EU2LN0LXx6AyjpOig+G0XEwOh5SosBqQUREzpPBCX344YekpKTQtWtXGvn5+TFu3DiWLFnCpEmTOJW/vz/PP/88jcaNG8fpZGRk8Mc//pF//OMfXHXVVYhI+1ZcBSv2w5Is+CoH6ho4KSEErkqAq7tDQggiItLKDE4oLy+P2NhYmouNjeWzzz7jdKxWK/3796eRl5cXp6qurmbChAk8+eSTxMbG8n3S09NZtWoVzeXk5BAeHk5paSnSOsrKyrDZbNTV1SHSVg6UevD5AU8+P2DIPGLFZqeJ8YBLIusZ3bWey7rWE+5n44TSUuQMysrKMMZgt9sREddWXl5OfX09VquV71JTU4O3tzfnw+CESktL8ff3p7mAgABKSko4FzNmzCA1NZXx48eTmZnJ96murqakpITm6uvrsdvt2Gw2pHXYbDbsdjs2mw0RR8o+bmXZAU+W7ffkmxIrJ/hY7QyJrmdUbB0jutTR0dvOCTYb8gPYbDZsNhs2mw0RcW02mw2bzYbNZuO72O12zpfBCYWGhrJ//36aO3bsGJ06deKHWrlyJa+99hqLFy8mPT2d7OxsGq1du5ZevXrRtWtXmhs9ejSjR4+muXnz5tEoKCgIaR11dXUEBATg6+uLSGv7phg+2gNLsuCbYk7q6A2j42HMRTCiqwVf4wl4IufHbrdjjCEwMBARcW1Wq5X6+nqCgoL4Lj4+PpwvgxPq2rUry5Yto7m9e/cSGxvLD1VcXExwcDD33HMPjerq6mg0ZcoU7rvvPmbPno2IuL5vimFJFizJgqyjnNTRGy6Pg6sS4NKu4GlFREQuMIMTuvHGG5kxYwZbtmwhOTmZ4uJiPv74Y1599VUaHT9+nKysLPr27YuPjw/f5/rrr+f666/nhMzMTBITE9m+fTtBQUGIiOvadQQ+/AY+2gP7SjgpxBfGXATjEmBIFzAeiIiIEzE4oS5duvDII49w5ZVXctVVV5Gens7ll1/OmDFjaLRy5UquueYaMjIy6Nu3LyLSfmQfgw++gfe/hqyjnBTqB1deBFclwKAuYLUgIiJOyuCk5syZw5VXXsnGjRu59dZbueyyy/Dw8KDR4MGDWb58OXFxcZzqX//6F3FxcXyXuLg4li9fTkBAACLiGnLL4MMseP9ryCjkpBBfuCoBrkqAgdFgtSAiIi7A4MRSU1NJTU3lVKGhoYwcOZLTGTRoEN/H39+fkSNHIiLO7Vg1fJ4N7+yGVTlg5/8EesOP4+CqBBjZDYwHIiLiYgwiIk6iog4+2QPv7YZVB6HBThNfA5fHwbU9YGQ38LYiIiIuzCAicgE12GFlDry7Gz7dC5V1NPG0wmVd4druMDoe/D0RERE3YRARuQB2FME7u+A/X0NRJU0swMBouKEnXJUAHb0RERE3ZBARaSP55fDRHnhrJ+wo4qT4YLi2O9zQE7oFISIibs4gIuJANQ3wyR54cyesOgg2O01CfeGa7nBDT+gfgYiItCMGEREHyCiEf++E/+yG4zU08THw43i4oSdc2hWMByIi0g4ZRERaSWkNfJgFr2dAZiEnJYTAjb3glr4Q7IOIiLRzBhGR82Czw5cHYPEO+Cwb6hpoEuoLN/SEm/tAj1BEREROMoiInIPCCli8A97IhMNlNLFa4PI4uLk3XB4HnlZERES+xSAicpbswKoceC0Dlu2DehtNugXBLX3gf3pBuD8iIiLfyyAicgalNfBhFry0Fb4pponVAsNiYWJfuPJHYLUgIiJyVgwiIt9hcx68vA0+3gO1DTSJDoQJfWF8HwjzR0RE5AcziIg0U9sAH2bBS1thewFNrBYYHQ+39oWR3cDDgoiIyDkziIj8V2EFvJYBr2fAkUqahPrChL5wayJEBSIiItIqDCLSrmUUwqIMeHsX1DTQpHdnuC0JbugJvgYREZFWZRCRdsdmh6V74dlNsCWfJsYDxiXAHf3gkmhEREQcxiAi7UZNA7y9C57bBNnHaBLsA7f0hduTICoQERERhzOIiNsrr4V/74RnN0F+OU26dIC7kuGWPuDniYiISJsxiIjbyi2DF7bAvzKhoo4mfcPgngEwLgGsFkRERNqcQUTczr4S+N+N8M5uqLfRZEQs3JMCQ2MQERG5oAwi4jZ2HYFnNsCSLLDZwXjAdT3gngHQuzMiIiJOwSAiLm9HETyzAT7KAjvgaYXrE2D6QIgPRkRExKkYRMRlrT4IT62HNYdo4ucJE/rClIshIgARERGnZBARl7PiADy1Djbl0STQG+7oB3f2h1BfREREnJpBRFyCHfgiG55aD1vzaRLiC3clw0+TINAbERERl2AQEadmBz7fB0+th20FNAn1hduS4GfJEOiNiIiISzGIiFOy2eGTPbBwPew+QpNwf5g6ACYmgq9BRETEJRlExKnYgU/2wJPrYPcRmkQFwr0DYHxf8LYiIiLi0gwi4hTswNI98OQ62HWEJlGBcF8qjO8NnlZERETcgkFELrj0HJi/CjIKaRIVCHdfDLcmgrcVERERt2IQkQvm82xYsAZ2FNEkMgCmpcAtfcHLioiIiFsyiEibS8+BP6+BLfk0iQiAaSkwoS94WREREXFrBhFpM5vz4PE1sPogTUJ8YcrFcGd/8DGIiIi0CwYRcbhtBbBgDXx5gCZBPjB1ANzRD/w8ERERaVcMIuIwe47C42tg6R6wAwFecPfF8LNkCPBCRESkXTKISKvLLYO/rIW3d0GDHfw84Y5+MHUABPkgIiLSrhlEpNWUVMOzm+DFLVDTAMYDJvaB+wdBuD8iIiLyXwYROW8VtfDsZnhhM1TUgYcFbugJvx4EsR0RERGRZgwics7qbbAoA55cD8WVNBkdDw8Mhp6dEBERkdMwiMgPZgeWZMHjq2H/MZqkRMFvhsGASEREROR7GBysrq6Ouro6/Pz8EHEHm/Pgj+mwIZcm8cEwczCMSwALIiIiciaGVmaz2fj3v//N22+/zcqVKyksLMRutxMYGEhKSgpjx47lnnvuITAwEBFXknUU/pgOX2TTJNwffjUIbuoNxgMRERE5S4ZW9OGHHzJ37lzi4uIYMmQIt912G927d8fPz4+srCy++eYbMjIySE5OZtq0aUybNg0fHx9EnFlxJTyxFv61A+ptEOAF9wyAn10MvgYRERH5gQytZNGiRWzatIl3332Xrl27cqrY2Fguv/xyGpWXl/Piiy+SlpbGggULEHFGdQ3wagY8sRbKasDDAv/TE9KGQyc/RERE5BwZWsnEiROZOHEiZyMgIIBf/OIXiDgjO/BRFjyWDgdLaTIsFuYMh56dEBERkfNkEJGTtuTDvC9haz5NeneGh4fD0BhERESklRgc4P3332f16tWcTnx8PFOmTEHEmeSXw/xV8N5usAPh/jBzCPykF3hYEBERkVZkcIDS0lLy8/NpbtOmTWRmZvLLX/4SEWdRXQ8vbYWnN0BFLXhaYVIizBwMAV6IiIiIAxgcYNKkSUyaNInm7HY7Dz/8MLt370bEGXyYBX9cCYfLaDIuAdKGQZcOiIiIiAMZ2ojFYuHGG2/kpptuQuRC+qYY5q6ANYdo0rszPHIpDIpGRERE2oChjRw7dozHH3+cK664ApELoawGnlwHL2+DehuE+MKsITC+D3hYEBERkTZicIDHH3+cxYsX01xWVhalpaX07t2blJQUGhljWLt2LSKOZAfe2QWPpUNRJXhY4H96wpwREOKLiIiItDGDA4wcOZLIyEjOxMPDAxFH2nUE0r6ATXk0SY2CR0dC786IiIjIBWJwgNTUVFJTUxG5UCpq4Ym18PI2qLdBmD/8Zhhc3xMsiIiIyIVkaCV2ux2LxcIPYbfbsVgsiLSmj7Lgt19BfjkYD7grGX49CAK8EBERESdgaCX/+te/+Pjjj7n//vu5+OKL+T55eXk888wzlJaW8tRTTyHSGnKOw5wVsGI/TfqGwR9HQb9wRERExIkYWsmECRO46KKLmDVrFjU1NQwdOpSEhAQSEhLw8fFhz549ZGVlkZGRwc6dO0lLS2PChAmInK96G/x9Ezy9HqrrIcgHZg+FW/qAhwURERFxMoZWNHDgQD777DOWL1/OW2+9xVNPPcXBgwepq6sjIiKClJQUrrvuOt544w08PT0ROV9b8uHBz2H3EbAAP+kFvxkGoX6IiIiIkzI4wGWXXcZll12GiKNU1cPCdfDcJmiwQ2xH+OMoGB6LiIiIODmDiItZtg/mLIe8cjAe8PMUmD4QfAwiIiLiAgwiLqK4Ch5ZAR98Q5PkCJh/OfTshIiIiLgQg4gL+OAbeGQFFFeBvyfMGgq3J4GHBREREXExBhEndqQSHl4OH++hycBo+NNoiAtCREREXJTBQbKysti1axc2m43mOnXqxLBhwxA5k3d2w2+/hGPVEOgNacPglr5gQURERFyZwQHeeecdbrrpJkJDQwkJCaG5gQMHMmzYMES+S3ElPPQFLN1Lk8u6wWOXQ2QAIiIi4gYMDvDcc89x991388wzz2C1WhE5W0v3wkNfQHEldPCGRy6Fn/RCRERE3IjBAfz9/bn66quxWq2InI2yGvhjOizKpMmwWHh8NEQFIiIiIm7G4AB33HEHr732GmPGjMHT0xOR77PqIMz4FPLKwc8THhoGtyWBBREREXFHBgdoaGjg66+/5kc/+hGpqan4+PhwQq9evUhLS0OkrgGeWAkvbAGbHQZEwhNXQLcgRERExI0ZHMDDw4MxY8ZwOp07d0Zkf6mVuZ96s/MIGA+YOgBmDgbjgYiIiLg5gwPExcUxYMAAoqOjETnV27sg7YtgquotdOkAT46B1ChERESknTA4wNy5c4mPj2fBggWInHCsGh5YBp/u478s3Nijgd+NsuLvhYiIiLQjBgeYO3cut99+O1u3bqV///6IbMqDn38MuWXQ0Rt+k1rKdb098fXyRURERNoXgwN88cUXVFZWkpycTFBQEP7+/pwwePBg3nzzTaR9sAMvbYU/rIR6G/QLh7+OBd/aGsATERERaX8MDjBu3Dj69OnD6YSEhCDtQ3EV/GopfHkALMDUATBrCBgPKCpCRERE2imDA/Tq1YtevXoh7dfmPJj2EeSVQ6gvPHEFjOyGiIiICAYHWLhwIe+++y6n079/f5588knEff1zG/xuJdQ1wMBo+OtYCPdHREREpInBAZKTk7FarZxQV1dHZmYmn3zyCb/5zW8Q91RdD3OWw7930mRiX/jdZWA8EBERETnJ4AAjRoxgxIgRnOqNN97g9ddf54orrkDcy74SmLoEvikGfy/482gYl4CIiIjItxja0ODBg5kxYwbiXlYcgOkfQ2kNJITAs1fDRcGIiIiInJbBAaqqqqipqaG58vJy5s+fT4cOHRD38fdN8KdV0GCHsT+CBVeAvyciIiIi38ngAA888ADPPPMMp/Lz8+PVV19FXF9NAzz0Oby9CyzAvSkwawh4WBARERH5XgYHeOyxx3j44YdpzmKxEBISgqenJ+LaCirgrvchoxD8veDJMXBFPCIiIiJnxeAAn3/+OV26dCElJYXmDh8+zDvvvMP06dMR17SzCCa/D3nl0C0IXrgGEkIQEREROWuGVrRx40b27NnDSy+9RHx8PHv27KG5TZs2sXz5cqZPn464ni8PwLSPoLwWBkTC89dAqC8iIiIiP4ihFS1dupQ333yTw4cPs2vXLtasWUNzXl5ePPDAA4jrWZQJc5ZDvQ2u6Q4LrgBvKyIiIiI/mKEVpaWlkZaWxvz58+nduzfXXnst4trswO+/ghe2gAWYMRimDwQLIiIiIufG4AAPPvggjdavX8+uXbsYMGAAYWFhhIaGYrVaEddQ1wAzlsF/vgYvK/z5x3BdD0RERETOi8EBampquPfee1m0aBH+/v789re/pbKykhdffJGlS5fStWtXxLlV1MG0JbDiAPh7wt+vhhGxiIiIiJw3gwPMnz+fLVu2kJOTwxNPPEGjn//852zevJmZM2fy5ptvIs7rSCX89D+QWQhh/vDP66B3Z0RERERahcEBVqxYwcyZMwkLC+MEPz8/Zs6cydVXX404r9wyuPVd2FcC8cHwyvUQ0wERERGRVmNwgE6dOlFcXMypysvL6dixI+KcDhyHie/AoVLo0xlevQFCfRERERFpVQYHuO2225g8eTKRkZFUVFRQXV1Neno69913HzfffDPifPaWwMR3IL8c+oXDK9dDkA8iIiIirc7gANdeey3z58/n5z//OYWFhTTy8vLivvvuY+7cuYhz2VkEk96F4ioYEgMvXAP+noiIiIg4hMFBfvazn3HXXXdx6NAhqqqqiIuLw9PTE3Euu47Are8QIqFqAAAgAElEQVTC0SoYFQd/vwq8rYiIiIg4jKEV2e121q9fT0lJCUOGDKFDhw7ExMRw7NgxDhw4QH5+PsuXL2fOnDnIhbe3BG57F45Wwchu8OxV4GVFRERExKEMreiGG27gP//5D40CAwNZuXIls2fPZunSpZxw4403IhfevhIY/xYUVcLIrvDc1eBlRURERMThDK1kxYoVfPTRRyxbtoyhQ4fywQcfMHToUKKjo1mzZg1RUVEEBQXRoUMH5MLKPgY3vQVHKmFkN3j+avCyIiIiItImDK1k586dDBkyhNGjR9Po5ptvJi0tjcmTJzNo0CDEOeSXw6R34UgljIiF564GLysiIiIibcbQSiorKwkKCqK5jh07Eh0djTiHkmqY9C4cKoXkCPj71eBtRURERKRNGaRdqKiDO/4DWUehZyf45/Xg74mIiIhImzOI26u3wbSPYGs+xHaEV6+Hjt6IiIiIXBCGVvT555/Ts2dPTjhw4ACzZs3i97//PScMHDiQV155BWk7876EFfsh1BdeuwHC/BERERG5YAytZOTIkZyNmJgYpO08txle3Q7eVnj+GujaEREREZELytBKUlJSSElJQZzHJ3vgsXTwsMCTY2BAJCIiIiIXnEHc0u4j8KtPwWaHh4bBuAREREREnIJB3M7xGpi6BCrr4IaecM8ARERERJyGQdyKzQ6/+AT2H4M+neGxyxERERFxKgZxKwvWwIr9EOoHL1wDvgYRERERp2JoJVu3biU9PZ0ziY6O5oYbbkBa31c58LeNYDzgb+MgKhARERERp2NoJVlZWbz33nucsHHjRiorK+nduzfe3t7s3LkTDw8PHn74YaT1FVfCjE/BZocZg2FQNCIiIiJOydBKbrrpJm666SYavffee8yd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Y8eoq6ujqqoKEXFtx48fx2q1UldXh4i4tvLychoaGrDb7XyXqqoqAgICOB8GB/jFL37B5s2biYuLIyAgAD8/P9LS0khISODjjz/mTAIDAyksLKS5iooKAgICOFe7d+9m8uTJHDp0iOeee45bbrmF05kyZQpTpkyhuXnz5tEoIiICRzuYS5OBMZ5ERETgrqxWKwEBAfj6+iIirs3b2xtjDIGBgYiIaysrK6O+vp7g4GC+S0BAAOfL4ABWq5VXX32VBx98kM2bN1NVVUWPHj0YMWIEFouFM4mKimLr1q00l5eXR1RUFOdizZo1jBkzhl/96lc89NBD+Pj44KwyC2mSGI6IiIiIWzI4iM1mIzs7m0OHDlFVVYW/vz/V1dX4+vpyJmPGjGHevHkcOXKETp060dDQwKeffsqDDz7ID2W325k8eTKzZs3i4YcfxtntLaFJQggiIiIibsngAMePH2fkyJHs2bOHgQMH4uPjw3PPPccDDzzAihUr6N69O99nwIABjBkzhuuuu46pU6fywQcfYIzhlltuodEnn3zCT37yEzZs2ECvXr34PllZWezevZtly5axdu1amnvooYcYOnQozmT/MZrEBSEiIiLilgwO8Oijj2KM4cCBA4SEhNCourqa22+/nenTp7N06VLO5O2332bhwoUsWbKEnj178re//Q1/f38axcfHM3PmTEJDQznV/fffT1JSEid4eXnxyCOPcDrBwcE4k6JKKK+FEF8I8kFERETELRkcYOvWrUyfPp2QkBBO8PHxYfbs2YwdO5az4eXlxQMPPMDpdO/enXnz5nE6999/P81169aNefPm4QoOldIktiMiIiIibsvgAImJiWRlZXGq7OxsevbsiZxecSVNQn0RERERcVsGB/j1r3/NmDFjqK2tZezYsfj6+rJu3Tr+8Ic/sGDBAjIzM2nk6+vLRRddhPyfo1U0CfVFRERExG0ZHGDBggVkZWWxYMECFixYQHN33HEHJ/Tv35+NGzci/6ekmiZBPoiIiIi4LYMDLFy4kIULFyI/TGUdTfy9EBEREXFbBgdYvHgxQ4cOpUuXLjSXm5vLq6++yuzZs5Fva7DTxGpBRERExG0ZHKCkpIR+/frx17/+lQkTJtDo9ddfZ/r06UyePBk5vXobTaweiIiIiLgtgwPcc8899OnThzvvvJMPPviA6upq1q1bxz//+U+u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wsJYvnw5AwcO5P777ycmJob777+fvLw8Dh48yGeffYZd8+bNefXVV4mPjycxMZEtW7bQr18/HnroIUTk9nvsscd47733uOeee+jatSsrV65k1qxZ+Pj4YDd37lz+8Y9/UFRUhLe3N3/4wx949NFH6d+/PxcvXmTDhg3Mnj2b4OBggoODGTVqFD169KBv376Ul5eTmZnJypUruVkGIrdAaGgoO3fuZN26dZw9e5Y5c+bQokUL6ixcuBAXFxfsfve73zFp0iSu5u7ujp2Xlxe7du1i1apVHD16lHHjxjFgwAAMw0BEbr/Q0FB27tzJunXrOHv2LHPmzKFFixbUWbhwIS4uLtg5ODjw3//936xbt45Dhw7h5+dH//798fPzo860adOIj49nx44djBw5kr59+2IymRCR28/JyYnPPvuMDRs2kJ2dzeTJk4mJiaHO+PHjGTJkCHVefvllBgwYwNatWzEMgz/+8Y9ERkZS591332Xs2LGkpqYSEBBA//798fX15WYZiNwiPj4+DBs2jGvp3LkzdTp16sR3cXR0ZMiQIYjIT8PHx4dhw4ZxLZ07d+Zq/fv3p3///lxP165d6dq1KyLS8BwdHXnooYe4llatWtGqVSvqi4mJISYmhuvp3bs3vXv35scwEBERERFpQAYiIiIiIg3IQERERESkARmIiIiIiDQgAxERERGRBmQgIiIiItKADEREREREGpCBiEgj8uGHH7J48WLqmEwmmjdvzrBhw+jTpw+3ysaNG1mwYAHjx4/n/vvv50aSk5M5d+4czz//PAcPHuSrr77iySefxDAMvq+amhpGjBjB6NGjSUpKor6amhqGDx/O2LFjGThwIDeSnJzMuXPneP7557lZ7733HpGRkXTr1o3k5GTOnTvH888/T0pKCqdPn2bw4MHcCv/85z+pqalh4MCBfJeKigrmzJnD9OnTEZGmw0BEpBFJT09n9+7dvPzyy9hVVlaydu1aFixYwIcffsiwYcP4IYYMGcK4ceNISEjA7qmnnmLYsGFERETwXQ4cOMDp06ex27BhA88//zwjRozAw8OD78tsNuPg4MBf/vIXkpKSqG/Tpk18/PHHvPXWW3yXAwcOcPr0ab6PlJQU5syZw5o1a7CbPHkyTz75JN26dePAgQOcPn0auwULFpCTk8PgwYM5deoUXbt2ZcuWLfj5+XGzamtrmTZt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">
</div>
</div>
</section>
<section id="black-litterman" class="level3" data-number="27.4.3">
<h3 data-number="27.4.3" class="anchored" data-anchor-id="black-litterman"><span class="header-section-number">27.4.3</span> Black-Litterman</h3>
<p>The Black-Litterman model combines the views of investors with market equilibrium assumptions to generate optimal portfolios. It starts with a market equilibrium portfolio and adjusts it based on investor views and confidence levels. The model incorporates subjective opinions while maintaining diversification and risk management principles.</p>
<p><span class="math display">\[
\begin{aligned}
\text{maximize} \quad &amp; \mu_{BL}^{T} w \;-\; \frac{\lambda}{2}\, w^{T} \Sigma \, w \\
\text{subject to} \quad &amp; \sum_{i=1}^{N} w_i = 1 \\
&amp; w_i \geq 0, \quad \forall i \\
\text{where} \mu_{BL} = \\
\Big( (\tau \Sigma)^{-1} + P^{T} \Omega^{-1} P \Big)^{-1}
\Big( (\tau \Sigma)^{-1} \mu + P^{T} \Omega^{-1} Q \Big)
\end{aligned}
\]</span></p>
<p><span class="math inline">\(μ\)</span> = prior (implied) returns from the market equilibrium. <span class="math inline">\(P\)</span> = matrix encoding which assets your views are on. <span class="math inline">\(Q\)</span> = your views (expected returns for specific portfolios). <span class="math inline">\(Ω\)</span> = uncertainty (covariance) of your views. <span class="math inline">\(τ\)</span> = scaling factor for the prior covariance (usually small, like 0.025).</p>
<div id="12" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Market equilibrium parameters (prior)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>λ <span class="op">=</span> <span class="fl">2.5</span> <span class="co"># risk aversion</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>μ_market <span class="op">=</span> [<span class="fl">0.08</span>, <span class="fl">0.08</span>, <span class="fl">0.08</span>] <span class="co"># Market equilibrium return</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>Σ_prior <span class="op">=</span> Σ <span class="co"># Market equilibrium covariance matrix</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Investor views</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> μ <span class="co"># Expected returns on assets according to investor views</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="fu">Matrix</span>(I, nₐ, nₐ) <span class="co"># Pick matrix specifying which assets views are on</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>Ω <span class="op">=</span> <span class="fu">Diagonal</span>([<span class="fl">1e-6</span>, <span class="fl">4e-6</span>, <span class="fl">9e-6</span>])  <span class="co"># Views uncertainty (covariance matrix)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Black-Litterman expected return adjustment</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>Σ_inv <span class="op">=</span> <span class="fu">inv</span>(Σ_prior)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>τ <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># Scaling factor</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior expected returns</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> Σ_inv <span class="op">/</span> τ <span class="op">+</span> P<span class="op">'</span> <span class="op">*</span> (Ω <span class="op">\</span> P)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> Σ_inv <span class="op">*</span> μ_market <span class="op">/</span> τ <span class="op">+</span> P<span class="op">'</span> <span class="op">*</span> (Ω <span class="op">\</span> Q)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>μ_posterior <span class="op">=</span> A <span class="op">\</span> B</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective: maximize sharpe ratio</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Max, λ <span class="op">/</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu">dot</span>(w, Σ_prior <span class="op">*</span> w) <span class="op">-</span> <span class="fu">dot</span>(μ_posterior, w))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the optimization problem</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>w_opt <span class="op">=</span> <span class="fu">value</span>.(w)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>ret <span class="op">=</span> <span class="fu">dot</span>(μ_posterior, w_opt)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>vol <span class="op">=</span> <span class="fu">sqrt</span>(<span class="fu">dot</span>(w_opt, Σ <span class="op">*</span> w_opt))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Optimal Portfolio Weights, Expected Portfolio Return, Portfolio Volatility:"</span>, ret, vol)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, w_i) <span class="kw">in</span> <span class="fu">enumerate</span>(w_opt)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Asset "</span>, i, <span class="st">": "</span>, <span class="fu">round</span>(w_i, digits<span class="op">=</span><span class="fl">4</span>))</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Portfolio Weights, Expected Portfolio Return, Portfolio Volatility:0.10000326065215620.31622776475673336
Asset 1: 1.0
Asset 2: 0.0
Asset 3: 0.0</code></pre>
</div>
</div>
</section>
<section id="risk-parity" class="level3" data-number="27.4.4">
<h3 data-number="27.4.4" class="anchored" data-anchor-id="risk-parity"><span class="header-section-number">27.4.4</span> Risk Parity</h3>
<p>Risk parity is an asset allocation strategy that allocates capital based on risk rather than traditional measures such as market capitalization or asset prices. It aims to balance risk contributions across different assets or asset classes to achieve a more stable portfolio. Risk parity portfolios often include assets with different risk profiles, such as stocks, bonds, and commodities.</p>
<p><span class="math display">\[
\begin{aligned}
\min_{w \in \mathbb{R}^N} \quad &amp; \sum_{i=1}^{N} \left( RC_i - t \right)^2 \\
\text{subject to} \quad &amp; \sum_{i=1}^{N} w_i = 1, \\
&amp; w_i \ge 0, \quad i = 1, \dots, N \\
\text{where} \quad
RC_i = \frac{w_i (\Sigma w)_i}{w^{T} \Sigma w + \epsilon}
\end{aligned}
\]</span></p>
<div id="14" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective: minimize portfolio variance</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="pp">@expression</span>(model, var_p, <span class="fu">dot</span>(w, Σ <span class="op">*</span> w))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="pp">@expression</span>(model, σ_p, <span class="fu">sqrt</span>(var_p <span class="op">+</span> <span class="fu">eps</span>()))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="pp">@expression</span>(model, Σw[i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>nₐ], <span class="fu">sum</span>(Σ[i, j] <span class="op">*</span> w[j] <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="pp">@expression</span>(model, RC[i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>nₐ], w[i] <span class="op">*</span> Σw[i] <span class="op">/</span> σ_p)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> nₐ</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Min, <span class="fu">sum</span>((RC[i] <span class="op">-</span> target)<span class="op">^</span><span class="fl">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the optimization problem</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>w_opt <span class="op">=</span> <span class="fu">value</span>.(w)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Optimal risk parity portfolio weights:"</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, w_i) <span class="kw">in</span> <span class="fu">enumerate</span>(w_opt)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Asset "</span>, i, <span class="st">": "</span>, <span class="fu">round</span>(w_i, digits<span class="op">=</span><span class="fl">4</span>))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal risk parity portfolio weights:
Asset 1: 0.5003
Asset 2: 0.4997
Asset 3: 0.0</code></pre>
</div>
</div>
</section>
<section id="sharpe-ratio-maximization" class="level3" data-number="27.4.5">
<h3 data-number="27.4.5" class="anchored" data-anchor-id="sharpe-ratio-maximization"><span class="header-section-number">27.4.5</span> Sharpe Ratio Maximization</h3>
<p>The Sharpe ratio measures the risk-adjusted return of a portfolio and is calculated as the ratio of excess return to volatility. Maximizing the Sharpe ratio involves finding the portfolio allocation that offers the highest risk-adjusted return. This approach focuses on achieving the best tradeoff between risk and return.</p>
<p><span class="math display">\[
\begin{aligned}
\text{maximize} \quad &amp; \frac{E[R_p] - rfr}{\sigma_p} \\
\text{subject to} \quad &amp; \sum_{i=1}^{N} w_i = 1 \\
&amp; w_i \geq 0, \quad \forall i
\end{aligned}
\]</span></p>
<div id="16" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective: minimize portfolio variance</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>rfr <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># risk free rate</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Max, (<span class="fu">dot</span>(μ, w) <span class="op">-</span> rfr) <span class="op">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(w[i] <span class="op">*</span> Σ[i, j] <span class="op">*</span> w[j] <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ, j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ) <span class="op">+</span> <span class="fu">eps</span>()))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the optimization problem</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>w_opt <span class="op">=</span> <span class="fu">value</span>.(w)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Optimal portfolio weights using Sharpe Ratio:"</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, w_i) <span class="kw">in</span> <span class="fu">enumerate</span>(w_opt)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Asset "</span>, i, <span class="st">": "</span>, <span class="fu">round</span>(w_i, digits<span class="op">=</span><span class="fl">4</span>))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal portfolio weights using Sharpe Ratio:
Asset 1: 0.018
Asset 2: 0.5309
Asset 3: 0.451</code></pre>
</div>
</div>
</section>
<section id="robust-optimization" class="level3" data-number="27.4.6">
<h3 data-number="27.4.6" class="anchored" data-anchor-id="robust-optimization"><span class="header-section-number">27.4.6</span> Robust Optimization</h3>
<p>Robust optimization techniques aim to create portfolios that are resilient to uncertainties and fluctuations in market conditions. These techniques consider a range of possible scenarios and optimize portfolios to perform well across different market environments. A robust parameter in robust portfolio optimization is typically chosen to ensure the portfolio’s performance remains stable and satisfactory under different market conditions or variations in input data. Robust optimization may involve incorporating stress tests, scenario analysis, or robust risk measures into the portfolio construction process.</p>
<p><span class="math display">\[
\begin{aligned}
\text{minimize} \quad &amp; w^T \Sigma w + \gamma \|w - w_0\|_2^2 \\
\text{subject to} \quad &amp; \sum_{i=1}^{N} w_i = 1 \\
&amp; w_i \geq 0, \quad \forall i \\
&amp; \|(\Sigma^{1/2} (w - w_0))\|_2 \leq \epsilon
\end{aligned}
\]</span></p>
<div id="18" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span>, <span class="bu">Ipopt</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an optimization model</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(<span class="fu">optimizer_with_attributes</span>(Ipopt.Optimizer, <span class="st">"print_level"</span> <span class="op">=&gt;</span> <span class="fl">0</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up weights as variables to optimize</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@variable</span>(model, w[<span class="fl">1</span><span class="op">:</span>nₐ] <span class="op">&gt;=</span> <span class="fu">zero</span>(<span class="fl">0.0</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective: minimize portfolio variance</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>ε <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Uncertainty level</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>γ <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># Robustness parameter</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>w₀ <span class="op">=</span> [<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>] <span class="co"># expected weights</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Min, <span class="fu">dot</span>(w, Σ <span class="op">*</span> w) <span class="op">+</span> γ <span class="op">*</span> <span class="fu">sum</span>((w[i] <span class="op">-</span> w₀[i])<span class="op">^</span><span class="fl">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Constraints: Sum of portfolio weights should equal to 1, and all weights should be zero or positive</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>(w) <span class="op">==</span> <span class="fl">1</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="pp">@constraint</span>(model, <span class="fu">sum</span>((Σ[i, j] <span class="op">*</span> (w[i] <span class="op">-</span> w₀[i]) <span class="op">*</span> (w[j] <span class="op">-</span> w₀[j])) <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ, j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nₐ) <span class="op">&lt;=</span> ε)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the optimization problem</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>w_opt <span class="op">=</span> <span class="fu">value</span>.(w)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Optimal Portfolio Weights:"</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, w_i) <span class="kw">in</span> <span class="fu">enumerate</span>(w_opt)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Asset "</span>, i, <span class="st">": "</span>, <span class="fu">round</span>(w_i, digits<span class="op">=</span><span class="fl">4</span>))</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Portfolio Weights:
Asset 1: 0.3125
Asset 2: 0.3125
Asset 3: 0.375</code></pre>
</div>
</div>
</section>
<section id="asset-weights-from-different-methodologies" class="level3" data-number="27.4.7">
<h3 data-number="27.4.7" class="anchored" data-anchor-id="asset-weights-from-different-methodologies"><span class="header-section-number">27.4.7</span> Asset weights from different methodologies</h3>
<table class="table-striped table-hover caption-top table">
<caption>Optimized asset weights from different methodologies</caption>
<thead>
<tr class="header">
<th>Methodology</th>
<th>Asset weights</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Standard mean variance</td>
<td>[0.33, 0.17, 0.50]</td>
</tr>
<tr class="even">
<td>(with RBC costs)</td>
<td>[0.17, 0.83, 0.00]</td>
</tr>
<tr class="odd">
<td>Black-Litterman</td>
<td>[1.00, 0.00, 0.00]</td>
</tr>
<tr class="even">
<td>Risk parity</td>
<td>[0.50, 0.50, 0.00]</td>
</tr>
<tr class="odd">
<td>Sharpe ratio</td>
<td>[0.02, 0.53, 0.45]</td>
</tr>
<tr class="even">
<td>Robust</td>
<td>[0.31, 0.31, 0.38]</td>
</tr>
</tbody>
</table>
<p>Seeing from the asset weights from a standard mean variance approach, due to RBC costs asset weights shifted to ones with higher yields. Asset weights from Sharpe ratio approach aligns with the Sharpe ratio for each asset. Those from Robust approach seek results not far away from expected weights under different conditions.</p>
</section>
</section>
<section id="practical-considerations" class="level2" data-number="27.5">
<h2 data-number="27.5" class="anchored" data-anchor-id="practical-considerations"><span class="header-section-number">27.5</span> Practical considerations</h2>
<section id="fractional-purchases-of-assets" class="level3" data-number="27.5.1">
<h3 data-number="27.5.1" class="anchored" data-anchor-id="fractional-purchases-of-assets"><span class="header-section-number">27.5.1</span> Fractional purchases of assets</h3>
<p>In traditional portfolio optimization, fractional purchases of assets refer to the ability to allocate fractions or percentages of capital to individual assets. However, in certain contexts or practical implementations, fractional purchases may not be allowed or considered.</p>
<ul>
<li><p>Practical constraints. Some investment vehicles or platforms may restrict investors from purchasing fractions of shares or assets. For instance, certain mutual funds, exchange-traded funds (ETFs), or other investment products may require whole units of shares to be purchased.</p></li>
<li><p>Simplicity and cost-effectiveness. Handling fractional shares can add complexity and operational costs to portfolio management, especially in terms of transaction fees, administrative overhead, and reconciliation processes.</p></li>
<li><p>Market liquidity. Some assets may have limited liquidity or trading volumes, making it impractical or difficult to execute fractional purchases without significantly impacting market prices or transaction costs.</p></li>
<li><p>Regulatory considerations. Regulations in certain jurisdictions may impose restrictions on fractional share trading or ownership, potentially limiting the ability to include fractional purchases in portfolio optimization strategies.</p></li>
</ul>
</section>
<section id="large-number-of-assets" class="level3" data-number="27.5.2">
<h3 data-number="27.5.2" class="anchored" data-anchor-id="large-number-of-assets"><span class="header-section-number">27.5.2</span> Large number of assets</h3>
<p>In portfolio optimization, a penalty factor for a large volume of assets typically refers to a mechanism or adjustment applied to the optimization process to mitigate the potential biases or challenges that arise when dealing with a large number of assets. This concept is particularly relevant in the context of mean-variance optimization and other optimization frameworks where computational efficiency and practical portfolio management considerations come into play. Too many assets may have the following issues.</p>
<ul>
<li><p>Dimensionality. As the number of assets (or dimensions) increases in a portfolio, traditional optimization methods may become computationally intensive or prone to overfitting. This is because the complexity of the optimization problem grows exponentially with the number of assets.</p></li>
<li><p>Sparsity and concentration. In practice, not all assets may contribute equally to portfolio performance. Some assets may have negligible impact on the overall portfolio characteristics (such as risk or return) due to low weights or correlations with other assets.</p></li>
<li><p>Penalizing excessive complexity. A penalty factor can be introduced to penalize portfolios that overly diversify or allocate small weights to a large number of assets. This encourages the optimization process to focus on more significant assets or reduce the complexity of the portfolio structure.</p></li>
</ul>
<p>There are various ways to implement a penalty factor for a large volume of assets:</p>
<ul>
<li>Regularization techniques. Techniques like Lasso (L1 regularization) or Ridge (L2 regularization) regression can penalize small weights or excessive diversification by adding a penalty term to the objective function.</li>
<li>Subset selection. Methods that explicitly select a subset of assets based on their contribution to portfolio performance, rather than including all assets indiscriminately.</li>
<li>Heuristic adjustments. Introducing heuristic rules or adjustments based on practical portfolio management principles or empirical observations.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./similarity-calculation.html" class="pagination-link" aria-label="Similarity Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Similarity Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sensitivity-analysis.html" class="pagination-link" aria-label="Sensitivity Analysis">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>